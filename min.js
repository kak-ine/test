(async()=>{String.prototype.r=function(e,t){return this.replace(e,t)};let e=new TextDecoder;function t(t){let l=atob(t.r(/-/g,"+").r(/_/g,"/").r(/\./g,"=")),r=new Uint8Array(l.length);for(let e=0;e<r.length;e++)r[e]=l.charCodeAt(e);return e.decode(r)}let l,r,i,a,o,c,s,u,p=t("REMg65287J2067iM7LGX"),d=t("7LWc6re8IOyCrOyaqQ.."),h=t("PHA-PGJyPjwvcD4."),f=t("64uJ64Sk7J6E7J2EIOyeheugpe2VmOyEuOyalC4."),g=t("67mE67CA67KI7Zi466W8IDLsnpDrpqwg7J207IOBIOyeheugpe2VmOyEuOyalC4."),m=t("64-E67CwIOuwqeyngCDsvZTrk5zrpbwg7J6F66Cl7ZWY7IS47JqULg.."),_=t("7J20IOq4sOuKpeydgCBEQ-yduOyCrOydtOuTnCDqsKTrn6zrpqzsl5DshJzrp4wg7IKs7Jqp7ZWgIOyImCDsnojsirXri4jri6Qu"),y=t("7J20IOq4sOuKpeydgCDquIAg66qp66GdIO2OmOydtOyngOyXkOyEnOunjCDsgqzsmqntlaAg7IiYIOyeiOyKteuLiOuLpC4."),w=t("UEPrsoTsoIQg7Y6Y7J207KeA7JeQ7IScIOuLpOyLnCDsi5zrj4TtlbTso7zshLjsmpQu"),O=t("66Gc6re47JWE7JuD"),v=t("7ZmV7J24"),k=t("7Leo7IaM"),b=t("64Sk"),I=t("7KO87IaM6rCAIOyYrOuwlOultOyngCDslYrsirXri4jri6Qu"),x=t("7J20IOuwqeyGoeydhCDsi5zssq3tlZjsi5zqsqDsirXri4jquYw_"),C=t("7IOIIOywveyXkOyEnCDsl7TquLA."),A=t("7IOd67Cp7IahIOyjvOyGjA.."),L=t("66mU7Iuc7KeAIOuztOuCtOq4sA.."),E=t("64u16riAIOyeheugpQ.."),D=t("64yT6riAIOyeheugpQ.."),T=t("7IOd67Cp7IahIOyxhO2MhQ.."),q=t("7Iqk7YGs66Gk7ZW07IScIOyxhO2MheydtCDrqYjst4TsirXri4jri6Q."),J=t("7IOIIOuplOyLnOyngCDrs7TquLA."),K=t("67O06riw"),j=t("MjDqsJwg7J207IOB"),G=t("6rCc"),z=t("7IOIIOuplOyLnOyngCA."),Y=t("64uJ64Sk7J6E"),S=t("67mE67CA67KI7Zi4"),U=t("7L2U65OcIOyeheugpQ.."),$=t("7JeQ6rKMIOuLteq4gA.."),B=t("7JeQ6rKMIOuMk-q4gA.."),M=t("64yT6riAIOyTsOq4sA.."),Z=t("7IOIIOuMk-q4gCDsk7DripQg7KSR"),X=(t("66Gc65Sp7KSR7J6F64uI64ukLg.."),t("7LGE7YyFIOyEpOyglQ..")),N=t("64uk7KSRIO2ZlOuptCDsgqzsmqkgKOuniOuPhCk."),Q=t("67aA65Oc65-s7Jq0IOyKpO2BrOuhpCDslaDri4jrqZTsnbTshZg."),P=t("7Y-w7Yq4IO2BrOq4sCDtmZXrjIA."),R=t("67CY6rOg64uJIOyVhOydtOuUlCDtkZzsi5w."),F=t("65SU7Iuc7L2YIO2BrOq4sCDspITsnbTquLA."),H=t("6riAIOuCtOyaqeyXkCDrp4Htgawg7LaU6rCA"),V=t("7Ken7J2AIOyxhO2MhSDsp4Dsl7Dsi5zqsIQ."),W=t("67Cp7IahIOyXhuydtCDssYTtjIXssL3rp4wg7IKs7Jqp"),ee=t("7Jyg64-ZIOuhnOq3uOyduCDsiKjquLDquLA."),te=t("64uk7YGsIOuqqOuTnA.."),le=t("7LGE7YyFIO2RnOyLnCDrsKnrspU."),re=t("7J6Q64-Z7Kek67CpIOuwjyDqvKzrpqzrp5A."),ne=t("7J6Q64-Z7Kek67CpIOyCrOyaqQ.."),ie=t("6rys66as66eQIOyImOyglQ.."),ae=t("64uJ64Sk7J6EIOyVhOydtOy9mCDtkZzsi5w."),oe=t("7LGE7YyF"),ce=t("7IKt7KCc65CY7JeI6rGw64KYIOyhtOyerO2VmOyngCDslYrripQg6rKM7Iuc66y87J6F64uI64ukLg.."),se=t("6rO17KeA"),ue=t("7ISk66y4"),pe=t("7LGE7YyF67Cp7JeQIOyYpOyLoCDqsoPsnYQg7ZmY7JiB7ZWp64uI64ukIQ.."),de=t("7LGE7YyF7LC97JeQIOuLpOyLnCDsl7DqsrDtlojsirXri4jri6Qu"),he=t("7JWMIOyImCDsl4bripQg7Jik66WY"),fe=t("7JWMIOyImCDsl4bripQg7Jik66WYIChibG9ja19rZXkp"),ge=t("7J6Y66q765CcIOyalOyyreyeheuLiOuLpC4."),me=t("7J2066-47KeA6rCAIOuEiOustCDtgb3ri4jri6Qu"),_e=t("7J2066-47KeAIOyXheuhnOuTnOyXkCDsi6TtjKjtlojsirXri4jri6Qu"),ye=t("7J2066-47KeAIOyCreygnOyXkCDsi6TtjKjtlojsirXri4jri6Qu"),we=t("7JWE7KeBIOyXheuhnOuTnCDspJHsnbgg7J2066-47KeA6rCAIOyeiOyKteuLiOuLpC4."),Oe=t("7J2066-47KeAIOyXhuydtCDsmKzrpqzsi5zqsqDsirXri4jquYw_"),ve=t("7JeF66Gc65Oc7JeQIOyLpO2MqO2VnCDsnbTrr7jsp4DqsIAg7J6I7Iq164uI64ukLg.."),ke=t("7LGE7YyF7J20IOu5hO2ZnOyEse2ZlOuQmOyXiOyKteuLiOuLpC4."),be=t("7J2066-4IOyLpO2WieykkeyeheuLiOuLpC4."),Ie=t("7J2066-47KeAIOyyqOu2gA.."),xe=t("65Oc656Y6re4IOyVpCDrk5zroa3snLzroZwg7J2066-47KeAIOyYrOumrOq4sA.."),Ce=t("7J2066-47KeA66eMIOyYrOumtCDsiJgg7J6I7Iq164uI64ukLg.."),Ae=t("7LGE7YyF7J20IOu5hO2ZnOyEse2ZlOuQnCDqsKTrn6zrpqzsnoXri4jri6Qu"),Le=t("4oCA4oCB4oCE4oCF4oCG4oCH4oCI4oCJ4oCK"),Ee=t("64yT6riA7IiYIO2VmOydtOudvOydtO2KuA.."),De=t("7JiB7IOBIOy2lOqwgA.."),Te=t("67Cw7LmYIOuwlOq-uOq4sA.."),qe=t("67Cw7LmYIOyZhOujjCE."),Je=t("66qo67CU7J28IO2ZmOqyveyXkOyEnOuKlCDqtozsnqXtlZjsp4Ag7JWK7Iq164uI64ukLgrqt7jrnpjrj4Qg7IKs7Jqp7ZWY7Iuc6rKg7Iq164uI6rmMPw.."),Ke=t("7KCE7LK0IOuLq-q4sA.."),je=t("64uk7Jq066Gc65Oc"),Ge=t("64ur6riw"),ze=t("7J6Q64-Z7Kek67CpIOydtOuvuOyngOulvCDsgq3soJztlZjsi5zqsqDsirXri4jquYw_"),Ye=t("7J2066-47KeAIOyXheuhnOuTnA.."),Se=t("7J6Q64-Z7Kek67CpIOyXheuhnOuTnA.."),Ue=t("67KE7KCEIOyXheuNsOydtO2KuOuQqA.."),$e=t("7KCE7LK0IOuzgOqyveyCrO2VrSDrs7TquLA."),Be=t("6rWs66ek7ZWY7KeAIOyViuydgCDrlJTsi5zsvZjsnoXri4jri6Qu"),Me=t("7IKt7KCc"),Ze=t("7IKt7KCc7ZWY7Iuc6rKg7Iq164uI6rmMPw.."),Xe=t("7IKt7KCc65CcIOqyjOyLnOusvOydgCDrs7XqtaztlaAg7IiYIOyXhuyKteuLiOuLpC4."),Ne=t("VVJMIOuzteyCrA.."),Qe=t("SUQg7LCo64uo"),Pe=t("SVAg7LCo64uo"),Re=t("64uJ64Sk7J6EIOywqOuLqA.."),Fe=t("64uk7J2MIOydtOyaqeyekOulvCDssKjri6jtlZjsi5zqsqDsirXri4jquYw_"),He=t("7YKk7JuM65OcIOywqOuLqA.."),Ve=t("7KCE7LK0IOywqOuLqA.."),We=t("6rCk65-s66asIOywqOuLqA.."),et=t("7LaU6rCA"),tt=t("7LCo64uoIOyEpOyglQ.."),lt=t("7J207KCcIOq4gOydhCDsmKTrpbjsqr0g7YG066at7ZWY66m0PGJyPuuLpOydjCDrqZTribTrpbwg7IKs7Jqp7ZWgIOyImCDsnojsirXri4jri6Qh"),rt=document,nt=rt.body,it=rt.head,at=localStorage??null,ot=window.Worker&&!0,ct=window.navigator.clipboard.read&&!0,st=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),ut=st&&/Safari/i.test(navigator.userAgent),pt=[5e3,3e3,1e3],dt="getElementsByClassName",ht="querySelector",ft="innerText",gt="placeholder",mt="onclick",_t="dclivechat",yt="onopenlink",wt="ondcconerror",Ot="onimageclick",vt="hidden",kt="disabled",bt="div",It="span",xt="g-recaptcha-response",Ct="6Lc-Fr0UAAAAAOdqLYqPy53MxlRMIXpNXFvBliwI",At="subdirectory_arrow_right",Lt="arrow_downward",Et=(e,t=!0)=>(e=e.r("?","\\?"),t?new RegExp(e,"g"):new RegExp(e)),Dt=/:([^,:]+), ([^,:]+):/g,Tt=/dccon\.php\?no=([a-z0-9]+)/,qt=/twitch.tv\/(\?channel=)?([A-Za-z0-9_-]+)/,Jt=/href="(https?:\/\/)?(www.)?twitch.tv\/([^"]+)"/g,Kt=/youtu(.be\/|be.com\/watch\?v=|be.com\/v\/|be.com\/shorts\/|be.com\/live\/|be.com\/embed\/)([A-Za-z0-9_-]+)/,jt=/href="(https?:\/\/)?(www.)?youtu(.be\/|be.com\/watch\?v=|be.com\/v\/|be.com\/shorts\/|be.com\/live\/)([^"]+)"/g,Gt="https://",zt=Gt+"gall.dcinside.com/",Yt=Gt+"github.com/Joh1ah/dclivechat",St="/board/forms",Ut=St+"/article_submit",$t=St+"/comment_submit",Bt="/dccon/insert_icon",Mt=St+"/delete_submit",Zt=St+"/delete_password_submit",Xt=Number.parseInt,Nt=requestAnimationFrame,Qt=setTimeout,Pt=encodeURIComponent,Rt=String.fromCharCode,Ft=Date.now,Ht=Ft(),Vt="",Wt="",el="",tl="",ll="",rl=!1,nl=!0,il=!1,al=!1,ol=!1,cl=!0,sl="",ul="",pl="",dl=!1,hl=!1,fl=!1,gl=0,ml=0,_l="",yl=pt[0],wl=0,Ol=0,vl=!0,kl=!0,bl=!1,Il=99999,xl=!0,Cl="",Al=null,Ll=null,El=()=>0==gl,Dl=()=>El()?hl:fl,Tl=(...e)=>{let t="["+((Ft()-Ht)/1e3).toFixed(2)+"]";if(console.log(t,...e),DEBUG&&s){for(let l of e)t+=void 0===l?" undefined":" "+(l.toString?.()??"");Rl("p",s,{[ft]:t})}},ql=()=>{let e,t=new Promise((t=>e=t));return{r:e,p:t}},Jl=(e,t)=>{let l=t-e+1,r=Math.random()*l;return Math.min(e+Math.floor(r),t)},Kl=(e,t)=>{let l=e.indexOf(t);-1!=l&&e.splice(l,1)},jl=new TextEncoder,Gl=async e=>{let t=jl.encode(e),l=function(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}(await crypto.subtle.digest("SHA-256",t).catch(Tl));return"#"+l.slice(0,6)},zl=Le.split(""),Yl=e=>{let t="";for(let l=0;l<e;l++)t+=zl[Jl(0,zl.length-1)];return t},Sl=e=>e.split("||"),Ul=e=>{let t,l,r=rt.cookie.split(";");for(let n=0;n<r.length;n++)if(t=r[n].substring(0,r[n].indexOf("=")),l=r[n].substring(r[n].indexOf("=")+1),t=t.r(/^\s+|\s+$/g,""),t==e)return l;return"undefined"},$l=e=>{let t=e.split(".");return t[0]+"."+t[1]},Bl=(e,t)=>((e,t,l)=>e.style.setProperty(t,l))(rt.documentElement,e,t),Ml=async()=>{let{r:e,p:t}=ql();return Rl("script",nt,{onload:()=>{if("undefined"==typeof grecaptcha)return Tl("recaptcha is undefined");Tl("recaptcha v3 loaded"),e()},type:"text/javascript",src:Gt+"www.google.com/recaptcha/api.js?render="+Ct}),await t},Zl=async(e,t,l)=>{if("v3"==e)return t["g-recaptcha-token"]=await(async e=>{"undefined"==typeof grecaptcha&&await Ml();let{r:t,p:l}=ql();return grecaptcha.ready((()=>grecaptcha.execute(Ct,{action:e}).then(t).catch((e=>{Tl(e),t("")})))),await l})(l);Tl("recaptcha",e,"is not supported")},Xl=async(e,t,l,r)=>{let n,i=0,a=async()=>{if(i>1)return n;if(i+=1,n=await e(...t,l),!n)return So(ge);let o=Sl(n);if("false"==o[0]){if(1==o.length)return So(n);if("captcha"==o[1])return await Zl(o[2],l,r),await a()}return n};return await a()},Nl=1024,Ql="B.KB.MB.GB.TB.PB".split("."),Pl=e=>{let t=0,l=1,r=Nl;for(;t<Ql.length;){if(e<r){let r=e/l,n=10,i=2;for(;;){if(r<n)return r.toFixed(i)+Ql[t];n*=10}}l*=Nl,r*=Nl,t++}},Rl=(e,t,l,...r)=>{let n=rt.createElement(e);if(l)if("object"==typeof l)for(let e in l)n[e]=l[e];else"string"==typeof l&&r.push(l);for(let e of r)n.classList.add(...e.split("."));return t&&t.appendChild&&t.appendChild(n),n},Fl=(e,t,...l)=>Rl(It,e,{[ft]:t},"material-symbols-outlined.icon",...l),Hl=e=>{for(;e.lastChild;)e.removeChild(e.lastChild)},Vl=(e,...t)=>(e.classList.add(...t),e),Wl=(e,...t)=>(e.classList.remove(...t),e),er=()=>scrollTo(0,0),tr=!1,lr=(e,t,l=!1,r=!1)=>{e.onkeypress=n=>{!r&&tr||"Enter"==n.key&&(DEBUG&&Tl(n),st&&l||!st&&l&&n.shiftKey||(n.preventDefault(),t.click(),e.oninput?.()))}},rr=()=>zt+(nl?"mgallery/":il?"mini/":"")+"board/",nr=()=>zt+"board/",ir=()=>rr()+"lists?id="+Vt,ar=()=>rr()+"write/?id="+Vt,or=e=>rr()+"view/?id="+Vt+"&no="+e,cr=(...e)=>{let t="";for(let l of e)for(let e in l){let r=l[e];null==r&&(r="undefined"),t+="&"+e+"="+r}return t.substring(1)},sr=e=>{let t=e.match(/var _r = _d\('([A-Za-z0-9+=\/]+)'\)/);return t?(e=>{let t,l,r,n,i,a,o,c="yL/M=zNa0bcPQdReSfTgUhViWjXkYIZmnpo+qArOBslCt2D3uE4Fv5G6wH178xJ9K",s="",u=0;for(e=e.r(/[^A-Za-z0-9+/=]/g,"");u<e.length;)n=c.indexOf(e.charAt(u++)),i=c.indexOf(e.charAt(u++)),a=c.indexOf(e.charAt(u++)),o=c.indexOf(e.charAt(u++)),t=n<<2|i>>4,l=(15&i)<<4|a>>2,r=(3&a)<<6|o,s+=Rt(t),64!=a&&(s+=Rt(l)),64!=o&&(s+=Rt(r));return s})(t[1]):""},ur=(e,t)=>{let l=(t=(e=>{let t=Xt(e.substring(0,1));return t=t>5?t-5:t+4,e.r(/^./,t)})(t??u)).split(","),r="";for(n=0;n<l.length;n++)r+=Rt(2*(l[n]-n-1)/(13-n-1));return e.r(/(.{10})$/,r)},pr=()=>{let e;try{e=Tl}catch{e=console.log}let t={},l=(e,t,l)=>{let n=r(e,t,l);return n?n[0]:""},r=(e,l,r)=>{let n,i=l+r;void 0!==t[i]?n=t[i]:(n=new RegExp(`<${l}[^>]*class=["'][^"]*${r}[^"]*["'][^>]*(/?)>`,"g"),t[i]=n);let a=e.matchAll(n);if(!a)return null;let o=[];for(match of a){if(match[1]){o.push([match[0],""]);continue}let t=match.index,r=0,n=e.substring(t),i=0,a=n.matchAll(new RegExp(`<(/?)${l}[^>]*(/?)>`,"g"));for(let e of a)if(e[1]){if(i-=1,0==i){t=e.index,r=e[0].length;break}}else e[2]||(i+=1);o.push([n.substring(0,t+r),n.substring(match[0].length,t)])}return o},n=(e,t,r)=>{let n=l(e,t,r);return n?n[1]:""},i=e=>{let t="";for(let l of e.matchAll(/(>|$)(.*?)(<|^)/g))t+=l[2].trim();return t},a={},o=(e,t)=>{let l;void 0!==a[t]?l=a[t]:(l=new RegExp(`${t}="([^"]+)"`),a[t]=l);let r=e.match(l);return r?r[1]:null};return{_IH:n,_OH:(e,t,r)=>{let n=l(e,t,r);return n?n[0]:""},_OHA:(e,t,l)=>{let n=[],i=r(e,t,l);if(!i)return"";for(let e of i)n.push(e[0]);return n},_IT:(e,t,l)=>{let r=n(e,t,l);return r?i(r):""},_AT:(e,t,l,r)=>{let n=o(e,t);null!=n&&(l[r]=n)},_A:o,_TF:e=>/fix/.test(e),_DEBUG:e,_IO:i}},{_IH:dr,_OH:hr,_OHA:fr,_IT:gr,_AT:mr,_A:_r,_TF:yr,_DEBUG:wr,_IO:Or}=pr(),vr={},kr=(e,t)=>{let l;vr[t]?l=vr[t]:(l=new RegExp(`<[^>]+(id|name)=["']${t}["'][^>]+value=["']([^"']+)["']`),vr[t]=l);let r=e.match(l);return r?r[2]:""},br=(e,t,l)=>{let r=new RegExp(`<form[^>]+id=["']${t}["'][^>]*>.*?</form>`),n=e.match(r);return!!n&&(tn(n[0],l),!0)},Ir=()=>{let e;try{e=_DEBUG}catch{e=Tl}return{_TEXT:async(t,l={})=>{l.credentials||(l.credentials="include");let r=await fetch(t,l).catch(e);return r&&r.ok?(await r.text().catch(e)).replace(/(\n|\r|\t)/g,""):""}}},{_TEXT:xr}=Ir(),Cr=async(e,t={},l="")=>{t.credentials||(t.credentials="include"),t.method||(t.method="POST"),t.mode||(t.mode="cors"),t.body||(t.body=l);let r=await fetch(e,t).catch(Tl);return r&&r.ok?await r.text().catch(Tl):""},Ar={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},Lr=async(e,...t)=>{let l=cr(...t),r={headers:Ar,referrer:ar()};return Cr(e,r,l).catch(Tl)},Er=async(e,t="")=>{let l=await xr((e=>rr()+"delete/?id="+Vt+"&no="+e)(e));if(!l)return So("not available");let r={[xt]:"",_GALLTYPE_:Wt};if(!br(l,"delete",r))return So("no form");let n=sr(l);if(!n)return So("no secret");r.service_code=ur(r.service_code,n);let i=l.match(/formData \+= "&([0-9a-z]+)=([0-9a-z]+)&/);if(!i)return So("not valid");if(r[i[1]]=i[2],t&&(r.password=t),i=l.match(/dcc_key_v1 = document.getElementById\(["']([^"']+)["']\).getAttribute\(["']([^"']+)["']/),i){let e=l.match(new RegExp(`<input[^>]+id=["']${i[1]}["'][^>]*>`));e&&(r.dcc_key_v1=_r(e[0],i[2]))}return await Xl(Lr,[t?Zt:Mt],r,"delete_submit")},Dr=async(e,t,...l)=>{let r=cr(...l),n={headers:Ar,referrer:or(e)};return Cr(t,n,r).catch(Tl)},Tr=async(e,{num:t,id:l,value:r,vCurT:n},i="")=>{let a={ci_t:Ul("ci_c"),id:Vt,re_no:e,mode:"del",[xt]:"",_GALLTYPE_:Wt};return i&&(a[l]=r,a.no=t,a.re_password=i,a.v_cur_t=n),await Xl(Dr,[e,"/board/comment/comment_delete_submit"],a,"comment_delete_submit")},qr=async e=>{let t={r_key:el,gall_id:Vt,gall_no:tl,post_no:"",upload_ing:"N",_GALLTYPE_:Wt};try{let l=((e,t)=>{let l=Rl("form",null,{entype:"multipart/formdata"}),r=new FormData(l);for(let t in e)r.append(t,e[t]);return t&&t.name&&r.append("files[]",t,t.name),r})(t,e),r={credentials:"same-origin",referrer:zt,referrerPolicy:"strict-origin-when-cross-origin"},n=Gt+"upimg.dcinside.com/upimg_file.php?id="+Vt+"&r_key="+el,i=await Cr(n,r,l).catch(Tl);return i?JSON.parse(i).files[0]??null:null}catch(e){return Tl(e),null}},Jr=e=>{let t=cr({id:Vt,r_key:el,temp_no:e}),l={headers:Ar,credentials:"same-origin",referrer:zt+"/upload/image?xssDomain=dcinside.com",referrerPolicy:"strict-origin-when-cross-origin"},r=nr()+"temp/upimg_pop_del";Cr(r,l,t).catch(Tl).then((e=>"true"!=e&&An(ye)))},Kr={},jr=[],Gr=!1,zr=[],Yr=async()=>{if(!zr.length)return Gr=!1;let e=zr.shift(),t=e[0],l=e[1];if(null!=Kr[t])return l(Kr[t]),Qt(Yr,1);let r=await(async e=>{let t=zt+"dccon/package_detail",l={headers:Ar},r=cr({ci_t:Ul("ci_c"),package_idx:"",code:e}),n=await Cr(t,l,r).catch(Tl);if(!n)return null;try{return JSON.parse(n)}catch(e){return Tl(e),null}})(t).catch(Tl);if(!r)return l();let n=r.info.title,i=r.info.package_idx,a=[];for(let e of r.detail)a.push({title:e.title,buy:!1,package_idx:i,package_title:n,code:e.path});let o={title:n,idx:i,buy:!1,code:r.info.list_img_path,detail:a};Ur(o),l(Kr[t]),Qt(Yr,1)},Sr=e=>{let{r:t,p:l}=ql();return zr.push([e,t]),Gr||(Gr=!0,Yr()),l},Ur=e=>{let t=sn("dccon-pk")??{};if(null!=t[e.idx]){let l=t[e.idx];if(l.buy||!e.buy)return;l.detail=e.detail,l.buy=!0}else t[e.idx]=e;cn("dccon-pk",t)},$r=(e,t)=>{let l=(e=>{let t=sn("dccon-pk");if(!t)return null;for(let l in t)if(t[l].title==e)return t[l];return null})(e);if(!l||!l.detail)return null;for(let e of l.detail)if(e.title==t)return e;return null},Br=(e,t)=>{let l=$r(e,t);return l?Mr(l.code):null},Mr=e=>Gt+"dcimg5.dcinside.com/dccon.php?no="+e,Zr=async(e,t)=>{let l,r=await Lr(zt+"dccon/lists",{ci_t:Ul("ci_c"),target:e,page:t}).catch(Tl);if(!r)return 0;if("not_login"==r)return 0;if("{"!=r.substring(0,1))return 0;try{l=JSON.parse(r)}catch(e){return Tl(e),{}}let n=l.list,i=1;if("recent"==e){let e=[];for(let t of n){let l=t.list_img.match(Tt);l&&e.push({package_title:d,package_idx:t.package_idx,idx:t.idx,code:l[1],title:t.title})}Ca({title:d,idx:-1,detail:e})}else if("icon"==e){i=l.max_page;for(let e of n){let t=e.title,l=e.package_idx,r=e.main_img_url.match(Tt);if(!r)continue;let n=[];for(let r of e.detail){let e=r.list_img.match(Tt);e&&n.push({package_title:t,package_idx:l,idx:r.detail_idx,buy:!0,code:e[1],title:r.title})}let i={title:t,idx:l,buy:!0,code:r[1],detail:n};Ca(i),Ur(i)}}return i},Xr=async e=>{if(!e.buy)return An(Be);let t=e.package_idx,l=e.idx,r={id:Vt,no:void 0,package_idx:t,detail_idx:l,ci_t:Ul("ci_c"),input_type:"write",t_vch2:void 0,t_vch2_chk:void 0,c_gall_id:Vt,c_gall_no:void 0,[xt]:"",check_6:void 0,check_7:void 0,check_8:void 0,_GALLTYPE_:Wt};await Xl(Lr,[Bt],r,"insert_icon"),Aa("recent").catch(Tl)},Nr=async(e,t)=>{if(!e.buy)return An(Be);let l=e.package_idx,r=e.idx,n=aa();if(!n.length)return An(f);let a=xo[t],o={id:Vt,no:t,package_idx:l,detail_idx:r,name:n,ci_t:Ul("ci_c"),input_type:"comment",t_vch2:a.t_vch2,t_vch2_chk:a.t_vch2_chk,c_gall_id:Vt,c_gall_no:t,[xt]:"",check_6:a.check_6,check_7:a.check_7,check_8:a.check_8,_GALLTYPE_:Wt},c={};if(!al){let e=oa();if(e.length<2)return An(g);c.password=e}if(Dl()){let e=ca();if(!e.length)return An(m);c.code=e}ml&&(c.c_no=ml);let s=await Lr(Bt,o,c);"ok"==s?(Bi[t](-1,!0),i(0)):DEBUG&&Tl("insert dccon comment fail",s),Qt(na,500),Aa("recent")},Qr=(e,t,l)=>{let r=`<img class="dccon" src="${l}">`;e.innerHTML=e.innerHTML.r(t,r)},Pr=0,Rr=e=>{let t=(e=e.r(/onmousedown="[^"]+"/g,"").r(/class="written_dccon[^"]*"/g,'class="d"')).matchAll(/onerror="[^"]+"/g);for(let l of t){Pr++;let t="error-"+Pr;e=e.r(l[0],`id="${t}" onerror="window.postMessage(JSON.stringify({type:'${wt}',id:'${t}' }),'*')"`)}return e},Fr=(e,t)=>{let l=e.match(t);if(l){DEBUG&&Tl("replacing",e);for(let t of l)e=e.r(Et(t),(r=Pt(t.split('"')[1]),`onclick="window.postMessage(JSON.stringify({type:'${yt}',url:'${r}' }),'*')"`));DEBUG&&Tl("replaced",e)}var r;return e},Hr=e=>(e=Fr(e,Jt),e=Fr(e,jt)),Vr=e=>"https://image.dcinside.com/viewimage.php?id=&no="+e,Wr=e=>{yl=pt[e],Ll&&Ll.postMessage({type:"iv",iv:yl})},en=(e,t)=>{for(let l in t){let r=kr(e,l);r&&(t[l]=r)}!Wt&&Go._GALLTYPE_&&(Wt=Go._GALLTYPE_),!tl&&Go.gallery_no&&(tl=Go.gallery_no),Go.r_key&&(el=Go.r_key)},tn=(e,t)=>{let l=e.matchAll(/<input[^>]+name=["']([^"']+)["'][^>]+value=["']([^"']*)["']/g);if(l)for(let e of l)t[e[1]]=e[2]};DEBUG&&Tl("initializing");let ln=e=>(alert(e),0);if(!(e=>{let t=e.match(/^https?:\/\/(gall|m).dcinside.com\/([^\n]+)$/);if(!t)return ln(_);let l=null;return"gall"==t[1]?(l=t[2].match(/id=([A-Za-z0-9_]+)($|\&|#)/),nl=/^mgallery/.test(t[2]),il=/^mini/.test(t[2])):(rl=!0,l=t[2].match(/(board|mini)\/([A-Za-z0-9_]+)($|\?|\/|#)/),nl=rt[dt]("micon").length>0,il=rt[dt]("mnicon").length>0),l&&l.length?(Vt=rl?l[2]:l[1],1):ln(y)})(location.href))return;if(rt.cookie="m_dcinside_web=done; path=/; domain=.dcinside.com",Rl("meta",it,{name:"viewport",content:"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0"}),rl)return ln(w),location.href=ir();if(rt[_t])return rt[_t]();rt[_t]=()=>An(be),rt.title=p+" :: "+rt.title;let rn={},nn={},an=e=>{let t=JSON.stringify(e??rn);at?.setItem(_t,t)},on=(e,t)=>{rn[e]=t,nn[e]?.(t)},cn=(e,t)=>{on(e,t),an()},sn=e=>rn[e]??null,un=()=>{let e=at?.getItem("block_all");return e?JSON.parse(e):{on:1,word:"",id:"",nick:"",ip:""}},pn=()=>{let e=at?.getItem("block_parts");return e?JSON.parse(e):{}},dn=(e,t)=>pn()[e]??{on:1,word:"",id:"",nick:"",ip:"",name:t},hn=(e,t)=>!!t.on&&(fn(e,"title",t,"word",!0)||fn(e,"nickname",t,"nick")||fn(e,"id",t,"id")||fn(e,"ip",t,"ip")),fn=(e,t,l,r,n=!1)=>{if(!l[r])return!1;let i=Sl(l[r]);for(let l of i)if(n){if(e[t].includes(l))return!0}else if(e[t]==l)return!0;return!1},gn=e=>{e.on=1,(e=>{at?.setItem("block_all",JSON.stringify(e))})(e);for(let t of Si)hn(t,e)?Vl(t.chat,"block"):Wl(t.chat,"block")},mn=(e,t)=>{e.on=1;let l=pn();l[t]=e,(e=>{at?.setItem("block_parts",JSON.stringify(e))})(l);for(let t of Si)hn(t,e)?Vl(t.chat,"block"):Wl(t.chat,"block")},_n=(e,t,l)=>{let r=Sl(e[t]).filter((e=>""!=e));r.includes(l)||r.push(l),e[t]=r.join("||")},yn=(e,t,l)=>{let r=Sl(e[t]).filter((e=>""!=e));for(let e=0;e<r.length;e++)if(r[e]==l){r.splice(e,1);break}e[t]=r.join("||")};(async()=>{let e=await xr(ir()).catch(Tl),t=dr(e,bt,"login_box");if(DEBUG&&Tl("login",t),t){let e=dr(t,"button","btn_inout");if(DEBUG&&Tl("string",e),e&&e==O){al=!0;let e=gr(t,"strong","nickname");e&&(sl=e);let l=hr(t,"strong","writer_nikcon");if(l){let e=_r(l,"onClick").match(/\/([a-zA-Z0-9_-]+)['"]/);e&&(ul=e[1]),e=l.match(/src=["']([^"']+)["']/),e&&(pl=e[1],dl=yr(e[1]))}}}DEBUG&&Tl("login",al),l?.(),ll=kr(e,"gallery_name"),so[ft]=We+" - "+ll})(),Hl(nt),Vl(nt,vt);for(var wn=1;wn<99999;wn++)window.clearInterval(wn);for(wn=1;wn<99999;wn++)window.clearTimeout(wn);let On=STYLESHEET.r(/_w/g,"width").r(/_h/g,"height").r(/_b/g,"background").r(/_m/g,"margin").r(/_p/g,"padding").r(/_d/g,"display").r(/_i/g,"!important").r(/_P/g,"position").r(/_T/g,"top").r(/_B/g,"bottom").r(/_L/g,"left").r(/_R/g,"right").r(/_r/g,"relative").r(/_a/g,"absolute").r(/_o/g,"overflow").r(/_f/g,"flex").r(/_F/g,"font").r(/_j/g,"justify-content").r(/_g/g,"grid-").r(/_c/g,"calc").r(/_x/g,"100%");On=ut?On.r(/_s/g,""):On.r(/_s/g," or (max-width:700px)"),Rl("style",it,{[ft]:On}),Rl("link",it,{rel:"stylesheet",href:Gt+"fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"}),st&&Ml(),DEBUG&&Tl("ui"),s=Rl(bt,nt,"log",vt),er();let vn=Rl(bt,nt,"o");Rl(bt,vn,{[ft]:xe},"drop");let kn=Rl(bt,nt,"o"),bn=(e=!1)=>{DEBUG&&Tl("render overlay",e&&1==kn.childNodes.length,kn.childNodes.length),e&&1==kn.childNodes.length||!kn.lastChild?Wl(kn,"wait"):Vl(kn,"wait"),tr=0!==kn.childNodes.length},In=!0;rt.addEventListener("keyup",(e=>{"Enter"==e.key&&(In=!0)})),rt.addEventListener("keypress",(e=>{In&&"Enter"===e.key&&tr&&(kn.lastChild&&kn.lastChild.enter?.(),In=!1)}));let xn,Cn=({title:e,desc:t,options:l,close:r,html:n,input:i,nowrap:a})=>{l||(l=[{text:v,[mt]:e=>e()}]);let o=Rl(bt,kn,"modal");e&&Rl(bt,o,{[ft]:e},"tt");let c=Rl(bt,o,"desc");o.content=c,t&&(n?c.innerHTML=t:c[ft]=t);let s=()=>{Vl(o,vt),o.remove(),bn()};r&&Fl(Rl("a",o,{[mt]:s},"b.close.abs-tr"),"close"),void 0!==i&&(o.input=a?Rl("input",o,{type:"password",value:i},"nowrap"):Rl("textarea",o,{value:i}));let u=Rl(bt,o,"opts.fr");1===l.length&&(l[0].enter=!0);for(let e of l){let t=()=>{r[ft]="",Fl(r,"progress_activity","progress")},l=null!=e.icon,r=Rl("a",u,{[ft]:l?"":e.text??e,[mt]:e.onclick?()=>e.onclick(s,t):s},"sb.r");l&&(Fl(r,e.icon),Rl(It,r,{[ft]:e.text})),e.enter&&Qt((()=>{o.enter=()=>r.click(),a&&lr(o.input,r,!1,!0)}),100)}return bn(),o},An=e=>Cn({desc:e}),Ln=(e,{text:t,top:l=!1},...r)=>{Vl(e,"has-tooltip");let n=Rl(bt,e,"tooltip",l?"tp":"bt",...r);return Rl(It,n,{innerText:t}),n},En=(e,t=[])=>{e.oncontextmenu=e=>{e.preventDefault();let l=e.clientX,r=e.clientY;for(option of(xn&&xn.remove(),xn=Rl(bt,nt,"p.ctx"),xn.style.left=l+"px",xn.style.top=r+"px",t)){if(option.hr){Rl("hr",xn);continue}let e=Rl("a",xn,"fr.b");option.icon&&Fl(e,option.icon),option.text&&Rl(It,e,{[ft]:option.text}),option[mt]&&(e[mt]=option[mt])}return xn}};rt.addEventListener("click",(()=>{xn&&xn.remove(),xn=null}));let Dn=Rl("main",nt);DEBUG&&Tl("video");let Tn,qn=Rl(bt,Dn,"video"),Jn=Rl(bt,qn,"menu"),Kn=Rl(bt,qn,"main"),jn=!0,Gn=e=>{jn="boolean"==typeof e?e:!jn,jn?(Wl(Jn,"e"),Tn[ft]="expand_less"):(Yn&&Sn.click(),Vl(Jn,"e"),Tn[ft]="expand_more")};Rl(bt,Jn,{[mt]:Gn},"stretch");let zn=Rl("a",Jn,{[mt]:()=>{Vl(Kn,"go"),Wl(Mn,vt)}},"b");Fl(zn,"add"),Rl(It,zn,{[ft]:De});let Yn=!1,Sn=Rl("a",Jn,"b",kt),Un=Fl(Sn,"pan_tool"),$n=Rl(It,Sn,{[ft]:Te});Sn.onclick=()=>{Yn=!Yn,Yn?(Vl(Sn,".t"),Un[ft]="check",$n[ft]=qe,Vl(Kn,"rlc")):(Wl(Sn,".t"),Un[ft]="pan_tool",$n[ft]=Te,Wl(Kn,"rlc"))};let Bn=Rl("a",Jn,"b",kt);Fl(Bn,"close"),Rl(It,Bn,{[ft]:Ke}),Tn=Fl(Rl("a",Jn,{[mt]:Gn},"b.fix-tl"),"expand_less");let Mn=Rl(bt,Kn,"p.fr.blank"),Zn=Rl("a",Mn,{[mt]:()=>{Wl(Kn,"go"),Vl(Mn,vt)}},"b.abs-tr",vt);Fl(Zn,"close"),Fl(Mn,"link","ph").onclick=()=>Nn.focus();let Xn=()=>{""!==Nn.value?Wl(Mn,"blank"):Vl(Mn,"blank")},Nn=Rl("textarea",Mn,{[gt]:A,oninput:Xn,onchange:Xn},"src"),Qn=Rl("a",Mn,{[mt]:()=>Vn(Nn.value)},"sb");Rl(It,Qn,{[ft]:v}),lr(Nn,Qn);let Pn=[],Rn=[],Fn=()=>{if(cl)Wl(Jn,vt);else{let e=Math.min(Rn.length,1);Vl(Jn,vt),Pn.length=e;for(let e=1;e<Rn.length;e++)Rn[e]?.remove();Rn.length=e,Yn&&Sn.click()}if(Vl(Sn,kt),Wl(Sn,".t"),Wl(Kn,"go"),!Rn.length)return Yn&&Sn.click(),Vl(Bn,kt),Vl(Zn,vt),void Wl(Mn,vt);Wl(Bn,kt),Wl(Sn,kt),Wl(Zn,vt),Vl(Mn,vt),1==Rn.length?Bl("--r2t","0px"):Bl("--r2t","50%");let e=(Rn.length-1)/2,t=0,l=0;for(let r=0;r<Rn.length;r++){let n=Rn[r];Wl(n,..."r1.r2.c1.c2.c3.c4".split(".")),r<e?(Vl(n,"r1"),t++,Vl(n,"c"+t)):(Vl(n,"r2"),l++,Vl(n,"c"+l))}Bl("--rw1",t),Bl("--rw2",l)},Hn=e=>{let t=e.match(qt);if(t)return Wn(t[2]);let l=e.match(Kt);if(l){let t=0,r=e.match(/t=([0-9]+)/);return r&&(t=r[1]),ei(l[2],t)}ai(e)},Vn=e=>{if(DEBUG&&Tl("step 1",e),!e)return An(I);if("show log"==e)return Wl(s,vt);if("clear options"==e)return an({});if("show options"==e)return Tl(rn);if("refresh update"==e)return jo();let t=Pn.length;if(!/[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(e))return An(I);/^[A-Za-z]+:\/\//.test(e)||(e="https://"+e),DEBUG&&Tl("step 2",e),Hn(e),0===t&&1===Pn.length&&Gn(!1),Fn()};onmessage=e=>{let t;t="object"==typeof e.data?e.data:JSON.parse(e.data),t&&(t.type==wt?(e=>{let t=rt[ht]("#"+e).parentNode,l=t.classList.contains("d"),r=t.getAttribute("data-src"),n=Rl("img",null,{src:r,draggable:!1},l?"d":"_");l||(n[mt]=()=>onImageClick(r)),t.insertAdjacentElement("beforebegin",n),Vl(t,vt)})(t.id):t.type==yt?(e=>{let t=decodeURIComponent(e).r(/&amp;/g,"&");Cn({title:x,desc:t,options:[{text:C,icon:"open_in_new",[mt]:e=>{let l=Rl("a",null,{href:t,target:"_blank"});l.click(),l.remove(),e()}},{text:v,[mt]:e=>{Vn(t),e()},enter:!0}],close:!0})})(t.url):t.type==Ot&&((e,t)=>{let l=document[ht]("#"+t);if(!l)return;let r,n=l[dt]("img"),i=[],a=0;for(let t=0;t<n.length;t++){let l=n[t];if(l.classList.contains(vt))continue;if(l.classList.contains("d"))continue;let r=l.getAttribute("data-osrc");r==e&&(a=t),i.push(r)}DEBUG&&Tl(i,e,a);let o=!1,c=Rl(bt,kn,{[mt]:()=>{o||(Vl(r,"fo"),Qt((()=>{c.remove()}),200),bn(!0))}},"ipvs");r=Rl("img",c,{src:i[a],draggable:!1,[mt]:()=>{o=!0,Nt((()=>o=!1))}},"ipv");let s=Rl(bt,c,"fr"),u=Rl("a",s,{[mt]:()=>{o=!0;let e=Rl("a",null,{href:r.src,download:""});e.click(),e.remove(),Nt((()=>o=!1))}},"b");Fl(u,"download"),Rl(It,u,{innerText:je}),bn()})(t.src,t.id))};let Wn=e=>{ai(Gt+"player.twitch.tv/?channel="+e+"&parent=gall.dcinside.com")},ei=(e,t=0)=>{ai(Gt+"www.youtube.com/embed/"+e+"?start="+t,{allow:"autoplay; picture-in-picture"})},ti=null,li="",ri=!1,ni=0,ii=0,ai=(e,t={})=>{if(Nn.value="",Pn.includes(e)){let t=Rn[Pn.indexOf(e)];return Vl(t,"hl-alt"),void Qt((()=>Wl(t,"hl-alt")),500)}let l;cl||(Pn.length=0,Rn[0]?.remove(),Rn.length=0),Pn.push(e),cn("videos-"+Vt,Pn);let r=Rl(bt,Kn);Rn.push(r),l=()=>Rn.indexOf(r);let n=(t,l)=>{ti||(Vl(r,"drg"),ni=()=>r.getClientRects()[0].width/2,ii=()=>r.getClientRects()[0].height/2+50,Bl("--mx",t-ni()+"px"),Bl("--my",l-ii()+"px"),ti=r,li=e)},i=(e,t)=>{Nt((()=>{Bl("--mx",e-ni()+"px"),Bl("--my",t-ii()+"px")}))},a=Rl(bt,r,{onmousedown:e=>{n(e.clientX,e.clientY),onmouseup=()=>{Wl(r,"drg"),ti=null,onmouseup=null,onmousemove=null},onmousemove=e=>i(e.clientX,e.clientY)},onmousemove:()=>{if(!ti||ri)return;let e=l(),t=Rn.indexOf(ti);e!=t&&(Rn.splice(t,1),Rn.splice(e,0,ti),Pn.splice(t,1),Pn.splice(e,0,li),ri=!0,an(),Qt((()=>ri=!1),200),Fn())},ontouchstart:e=>{n(e.touches[0].clientX,e.touches[0].clientY);let t=()=>{Wl(r,"drg"),ti=null,ontouchend=null,ontouchcancel=null,ontouchmove=null};ontouchend=t,ontouchcancel=t,ontouchmove=e=>{i(e.touches[0].clientX,e.touches[0].clientY);let t=rt.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY);t?.onmousemove?.()}}},"grab.fr");Fl(a,"drag_indicator"),t.sandbox="allow-same-origin allow-scripts";let o=Rl("iframe",r,t);Fn(),o.src=e;let c=Rl("a",r,{[mt]:()=>((e,t)=>{Kl(Pn,e),Kl(Rn,t),an(),t.remove(),Fn()})(e,r)},"close.b.abs-tr");Fl(c,"close"),Ln(c,{text:Ge})};nn["videos-"+Vt]=e=>{for(let t of e)Pn.includes(t)||Hn(t)},Bn[mt]=()=>{Pn.length=0;for(let e of Rn)e.remove();Rn.length=0,an(),Fn()},DEBUG&&Tl("chat");let oi=[],ci=Rl(bt,Dn,"chat"),si=Rl(bt,ci,"hd");Rl(It,si,{[ft]:T},"h");let ui=!1,pi=Rl("a",si,{[mt]:()=>{ui||(ui=!0,jo("button"),Vl(di,"rotate-ccw-half"),Qt((()=>{ui=!1,Wl(di,"rotate-ccw-half")}),800))}},"help.b.abs-tl"),di=Fl(pi,"sync"),hi=Rl("a",si,{href:Yt,target:"_blank"},"help.b.abs-tr");Fl(hi,"help");let fi=Rl(bt,ci,"vp"),gi=Rl(bt,fi,"page"),mi=Rl(bt,ci,"cb-c"),_i=Rl("a",mi,{[mt]:()=>{for(;oi.length;)oi.shift().click()}},"r.b.ca.right.sd");Fl(_i,"close");let yi=()=>{oi.length?Wl(_i,"sd"):Vl(_i,"sd")},wi={},Oi={},vi=[],ki=Rl("a",mi,{[mt]:()=>{if(!vi.length)return;let e=vi.shift();for(let t of e[1])wi[e[0]](t);let t=Rl("a",null,{href:"#"+e[0]});t.click(),t.remove(),Ii()}},"r.b.nt.right.sd");Fl(ki,"notifications");let bi=Rl(It,ki,"cnt.abs-tl.fade"),Ii=()=>{vi.length?(Wl(ki,"sd"),Wl(bi,"fade"),bi[ft]=vi.length<10?vi.length:"9+"):(Vl(ki,"sd"),Vl(bi,"fade"))},xi=(e,t)=>"n"+e+"_"+t,Ci=(e,t,l=null)=>{if(!Oi[e])return void(DEBUG&&Tl("post",e,"is not my post"));let r=xi(e,t);if(!wi[r])return void(DEBUG&&Tl("comment",t,"is not a comment in interest"));let n=vi.find((e=>e[0]==r));n||(n=[r,[]],vi.push(n)),n[1].push(l),Ii()},Ai=(e,t,l)=>{Oi[e]=!0,wi[xi(e,t)]=l},Li=Rl("a",mi,{[mt]:()=>o(),onscroll:e=>e.preventDefault()},"r.pd.fr",st?"m":"_",vt),Ei=Rl(bt,Li,"not-hover");Fl(Ei,st?Lt:"pause"),Rl(It,Ei,{[ft]:q},"text",st?vt:"_");let Di=Rl(bt,Li,"hover");Fl(Di,Lt);let Ti=Rl(It,Di,{[ft]:J},"text",st?vt:"_"),qi=0;fi.onscroll=()=>{let e=Math.abs(gi.scrollHeight-fi.clientHeight-fi.scrollTop),t=qi-e;if(qi=e,e<2&&zi(),0!=t)return t<0&&vl&&e>2?0==Il?o():void(Il=Math.max(Il-1,0)):void(!vl&&e<2&&o())};let Ji={},Ki=async(e,t,l,...r)=>{let n,i=((e,t,l)=>l?e+l:e+t)(e,t,l);null!=Ji[i]?n=Ji[i]:(n=await Gl(i).catch(Tl),Ji[i]=n),n=function(e){let t=Xt(e.substring(1,7),16);return"hsl("+Math.floor(360*t/16777215)+",80%,60%)"}(n);for(let e of r)e&&(e.style.color=n)},ji=(e,t,l,r,n,i)=>{n&&Rl("img",e,{src:n},"nikcon");let a=Rl(It,e,{[ft]:t},"name"),o=null;l?i||(o=Rl(It,e,{[ft]:l},"ip.id")):r&&(o=Rl(It,e,{[ft]:r},"ip")),Rl(It,e,{[ft]:": "}),Ki(t,l,r,a,o)},Gi=e=>{Ol=e;let t=K;0!=e&&(t=e>20?j:e+G),Ti.innerText=z+t},zi=()=>{let e=gi.childNodes;for(;e.length>80;){let t=e[0];Yi(t)}},Yi=e=>{for(let t=0;t<Si.length;t++)if(Si[t].chat==e){Si.splice(t,1);break}let t=e[dt]("removed");t&&t.length&&(t[0].value=!0),e.remove(),a(!0)};a=(e=!1)=>{if(Il=e?1:0,vl)return fi.scrollTop=gi.scrollHeight},o=()=>{vl=!vl,vl?(Vl(Li,vt),Gi(0),a(!0)):Wl(Li,vt)};let Si=[],Ui={},$i={},Bi={},Mi={},Zi=e=>{vl||Gi(Ol+1),Wl(e,vt),a(!0)},Xi=async e=>{let t=e.num,l=Rl(bt,gi,"chl",vt),r=Rl("input",l,{type:vt,value:!1},"removed"),n=Rl(bt,l,"tt.r"),c=Rl(It,n),s=e.nickname,u=e.ip,p=(e=>{let t=e.matchAll(/&#x([0-9a-fA-F]+);/g);for(let l of t){let t=String.fromCodePoint("0x"+l[1]);e=e.replace(l[0],t)}return e})(decodeURIComponent(e.title)),d=e.id,h=e.img,f=e.fix,m=e.my??!1,_=un(),y=dn(Vt,ll);(hn(e,_)||hn(e,y))&&Vl(l,"block"),Si.push({chat:l,title:p,id:d,ip:u,nickname:s}),s?ji(c,s,d,u,h,f):Vl(l,"notify");let w,O=Rl(It,c,{[ft]:p},"tt"),b=!1,I=[];for(let t of p.matchAll(Dt)){let l=t[0],r=t[1],n=t[2],i=Br(r,n);i?(Qr(O,l,i),a(!0)):(I.push([l,r,n]),b||(b=!0,(async()=>{let{write:t}=await Co(e.num).catch(Tl);if(!t)return;let l=fr(t,"img","written_dccon");for(let e of l){let t=_r(e,"src").match(Tt);if(t)await Sr(t[1]).catch(Tl);else{let t=_r(e,"data-src").match(Tt);t&&await Sr(t[1]).catch(Tl)}}for(let e of I){let t=Br(e[1],e[2]);t&&Qr(O,Et(e[0]),t)}a(!0)})()))}if(t){n.id=xi(t,0);let e=Rl(bt,l,"w.zero");w=Rl(bt,e,"vp.post");let s=Rl(bt,w,{id:"pc-"+t},"page.pc"),p=!0;m&&Ai(t,0,(()=>{p&&n.click()}));let d=()=>{Vl(l,"open"),Wl(e,"zero"),i(0),vl&&o(),J(),Kl(oi,n),oi.push(n),oi.length>5&&oi.shift().click(),yi(),Co(t).catch(Tl).then((({text:e})=>{const t=e.matchAll(/<iframe[^>]*id="movieIcon([^"]*)"[^>]*>[^<]*<\/iframe>/g);t?(async()=>{for(const l of t){const t=zt+"board/movie/movie_view?no="+l[1],r=await xr(t);if(!r)continue;const n=r.match(/<video[^>]*poster="([^"]*)"[^>]*>[^<]*<source[^>]*src="([^"]*)"[^>]*type="([^"]*)"[^>]*>/);if(!n)continue;const i=Rl(bt,null,"v-container"),a=Rl(bt,i,"video_wrap");Rl("source",Rl("video",Rl(bt,a,"video_inbox"),{controls:!0,playsinline:!0,controlslist:"nodownload",poster:n[1],"data-no":l[1]},"dc_mv"),{src:n[2],type:n[3]}),e=e.r(l[0],i.outerHTML),i.remove()}s.innerHTML=e})():s.innerHTML=e}))};n.onclick=()=>{if(p=!p,gl==t&&i(0),p){for(Kl(oi,n),Vl(e,"zero"),Wl(l,"open");s.lastChild;)s.lastChild.remove();return a(),void yi()}d()};let h,f,_=Rl(bt,e,"cm",vt),y=Rl(bt,_,"vp"),O=Rl(bt,y,"page"),b=Rl("a",_,{[mt]:()=>h()},"ex.sm.r");Fl(b,"more_vert");let I=Rl("a",e,{[mt]:()=>{gl==t?i(0):i(t,l,x)}},"ic.r"),x=Rl(It,I,{[ft]:M}),C=Rl("a",e,{[mt]:()=>n.click()},"ex.alt");Fl(C,"expand_less");let A={},L=[],E=[],D=Rl(bt,O,"w"),T=0,q=0,J=async()=>{if("false"!=r.value)return;let e=await Lo(t).catch(Tl);if(!e)return;e.count?Wl(_,vt):Vl(_,vt);let o=T;for(let r in e.comments){if(L.includes(r))continue;L.push(r),q>20&&(D=Rl(bt,O,"w",vt),o++,q=0);let a=e.comments[r],c=Rl(bt,null,"w"),s=Rl("a",null,"cml.r");s.id=xi(t,r);let d=a.text,h=a.target,f=a.name;if(h){let t=e.comments[h];t&&(f=t.name),Vl(s,"re"),Fl(Rl(bt,s,"re-icon"),At)}let _=d.length>8&&d.substring(d.length-8)==_l;_?(_l="",Ai(t,h||r,(e=>{p&&n.click(),Vl(e,"hl"),Qt((()=>Wl(e,"hl")),500)}))):Ci(t,h,s),s.onclick=()=>i(t,l,x,s,h||a.num,a.name,f),null==A[h]?(A[a.num]=c,c.appendChild(s),D.appendChild(c),E.length==o&&E.push(D)):A[h].insertAdjacentElement("beforeend",s);let y=Rl(bt,s,"writer-dlc");ji(y,a.name,a.id,a.ip,a.img,a.fix),Rl(bt,s,{innerHTML:d},"text"),q++;let w=[{text:Me,icon:"delete",[mt]:async()=>{let e="",{delId:l,delValue:n,vCurT:i}=await Co(t).catch(Tl);if(u||a.ip){let{r:t,p:l}=ql(),r=Cn({title:S,input:e,nowrap:!0,options:[{text:v,[mt]:l=>{if(e=r.input.value,e.length<2)return An(g);l(),t(!0)}},{text:k,[mt]:e=>{e(),t(!1)}}]});if(!await l)return}let o=await Tr(r,{num:t,id:l,value:n,vCurT:i},e);o||An(he);let c=o.split("||");return"true"==c[0]?(s.remove(),J()):1==c.length?An(o):void An(he)}}];(m||u||_||a.ip||a.id==ul)&&En(s,w)}f(),a(!0)};h=()=>{T++;let e=E[T];e&&Wl(e,vt),f()},f=()=>{T+1==E.length?Vl(b,vt):Wl(b,vt)};let K=Rl(It,c,"cm.fr",vt);Fl(K,At,"f");let j=Rl(bt,K,"nc.gray-div"),G=Rl(It,K,{[ft]:"+"}),z=[],Y=[],U=[];for(let e=0;e<3;e++){let t=Rl(bt,j,"num-"+e);Y.push(Rl(It,t,"old")),U.push(Rl(It,t,"new")),z.push(t)}let $=(e,t,l)=>{let r=3-t+e,n=U[r][ft];Y[r][ft]=n,U[r][ft]=l,l!=n&&(Vl(z[r],"changed"),Qt((()=>Wl(z[r],"changed")),500))},B=e=>(e+"").split("").reverse();Bi[t]=(e=-1,l=!1)=>{if("false"!=r.value)return void delete Bi[t];let n=()=>{-1==e&&(e=$i[t]+1),$i[t]=e;let l=B(e);l.length>3?(l="999".split(""),Wl(G,vt)):Vl(G,vt);for(let e=0;e<l.length;e++)$(e,l.length,l[e]);e?(Wl(K,vt),a(!0)):Vl(K,vt),p&&!Oi[t]||J().catch(Tl)};l?n():Qt(n,Jl(1,yl))}}if(e.date){let t=Ft()-e.date;(t>yl||!bl)&&Zi(l),Qt((()=>Zi(l)),yl-t)}else Zi(l);vl||zi();let x=[];(m||u||al&&d==ul)&&x.push({text:Me,icon:"delete",[mt]:()=>{Cn({title:Ze,desc:Xe,options:[{text:v,enter:!0,[mt]:async(e,r)=>{r();let n="";if(u){let{r:t,p:l}=ql(),r=Cn({title:S,input:n,nowrap:!0,options:[{text:v,enter:!0,[mt]:(e,l)=>{if(n=r.input.value,n.length<2)return An(g);t(!0),e()}},{text:k,[mt]:e=>{t(!1),e()}}]});if(!await l)return e()}let i=await Er(t,n);e();let a=i.split("||");if("false"==a[0])return An(a[1]);Yi(l)}},{text:k}]})}},{hr:!0}),t&&(x.push({text:C,icon:"open_in_new",[mt]:()=>{let e=Rl("a",null,{href:or(t),target:"_blank"});e.click(),e.remove()}},{text:Ne,[mt]:()=>{window.navigator.clipboard.writeText(or(t))}}),m||!u&&d==ul||(x.push({hr:!0}),u?x.push({text:Pe,[mt]:()=>{Cn({title:Fe,desc:"IP: "+u,options:[{text:We,[mt]:e=>{let t=dn(Vt,ll);t.on=1,_n(t,"ip",u),mn(t,Vt),e()}},{text:Ve,[mt]:e=>{let t=un();t.on=1,_n(t,"ip",u),gn(t),e()}},{text:k}]})}}):x.push({text:Qe,[mt]:()=>{Cn({title:Fe,desc:"ID: "+d,options:[{text:We,[mt]:e=>{let t=dn(Vt,ll);t.on=1,_n(t,"id",d),mn(t,Vt),e()}},{text:Ve,[mt]:e=>{let t=un();t.on=1,_n(t,"id",d),gn(t),e()}},{text:k}]})}}),x.push({text:Re,[mt]:()=>{Cn({title:Fe,desc:s,options:[{text:We,[mt]:e=>{let t=dn(Vt,ll);t.on=1,_n(t,"nick",s),mn(t,Vt),e()}},{text:Ve,[mt]:e=>{let t=un();t.on=1,_n(t,"nick",s),gn(t),e()}},{text:k}]})}}))),x.length&&(En(n,x),En(w,x))};DEBUG&&Tl("input login");let Ni=Rl(bt,ci,"li-c"),Qi=Rl("a",Ni,{[mt]:()=>c()},vt,"ex.tab"),Pi=Fl(Qi,"expand_more");c=()=>{xl=!xl,xl?(Pi.innerText="expand_more",Wl(Fi,vt)):(Pi.innerText="expand_less",Vl(Fi,vt)),a(!0)};let Ri,Fi=Rl(bt,Ni,"fr",vt),Hi=Rl("input",Fi,{type:"text",[gt]:Y,maxlength:15,name:"name"}),Vi=Rl("input",Fi,{type:"password",[gt]:S,maxlength:20,name:"password"}),Wi=Rl(bt,Ni,"fr",vt),ea=Rl("a",Wi),ta=Rl("img",ea,{[mt]:()=>na()},"captcha"),la=Rl("input",Wi,{type:"text",[gt]:U,maxlength:20}),ra=()=>{il&&(Cl?(Hi.value=Cl,Vl(Hi,kt)):Wl(Hi,kt))},na=async()=>{if(la.value="",Dl()){let e=El(),t={ci_t:Ul("ci_c"),gall_id:Vt,kcaptcha_type:e?"write":"comment",_GALLTYPE_:Wt},l=zt+"kcaptcha/session";e?await Lr(l,t).catch(Tl):await Dr(gl,l,t).catch(Tl),ta.src=zt+"kcaptcha/image/?gall_id="+Vt+"&kcaptcha_type="+(e?"write":"comment")+"&time="+Ft()+"&_GALLTYPE_="+Wt,Wl(Wi,vt)}else Vl(Wi,vt)};l=()=>{al||sn(ee)?Vl(Ni,vt):(Wl(Fi,vt),Wl(Qi,vt),a(!0)),Ri?.()};let ia=()=>Hi.value??"",aa=()=>Cl||(al?sl:ia()),oa=()=>Vi.value??"",ca=()=>la.value??"",sa=Rl(bt,ci,"ri-c",vt),ua=Rl(bt,sa,"tab"),pa=Rl(It,ua,"name"),da=Fl(ua,"more_horiz",vt),ha=Rl(It,ua,"name",vt),fa=Rl(It,ua,{[ft]:$});DEBUG&&Tl("input chat");let ga=Rl(bt,ci,"ci-c"),ma=Rl(bt,ga,"f"),_a=Rl(bt,ma,"i"),ya="--ih",wa=Rl("textarea",_a,{[gt]:L,oninput:()=>{Bl(ya,wa.clientHeight+12+"px"),wa.style.height=0,wa.style.height=wa.scrollHeight-19+"px",a(!0),Nt((()=>Bl(ya,0)))},onblur:er},kt),Oa=null,va=null,ka=null;i=(e,t,l,n=null,i=0,o="",c="")=>{if(null!=n&&n==ka&&(e=0,i=0),Oa&&va&&(ka&&Wl(ka,"rp"),Wl(Oa,"wr"),Wl(Oa,"rp"),va[ft]=M,Wl(va,"f-white"),Vl(sa,vt),Wl(fi,"r"),Vl(da,vt),Vl(ha,vt)),gl=e,ml=i,El())ol&&(Vl(wa,kt),Vl(Na,kt),Vl(Da,kt),Vl(Io,kt),al||Vl(Ni,vt)),Wl(ga,"wr"),wa[gt]=L,Oa=null,va=null,ka=null;else{if(ol&&(Wl(wa,kt),Wl(Na,kt),Wl(Da,kt),Wl(Io,kt),al||Wl(Ni,vt)),Vl(ga,"wr"),Vl(t,"wr"),n&&i)Vl(n,"rp"),Vl(t,"rp"),wa[gt]=E,pa[ft]=o,o!=c&&(ha[ft]=c,Wl(da,vt),Wl(ha,vt)),fa[ft]=$,l[ft]=k,Wl(l,"f-white");else{let t=Ui[e];pa[ft]=t.name,wa[gt]=D,fa[ft]=B,l[ft]=Z,Vl(l,"f-white")}Wl(sa,vt),Vl(fi,"r"),Oa=t,va=l,ka=n??null,wa.focus()}r(),na(),Sa(),ra(),a(!0)},DEBUG&&Tl("dccon");let ba=Rl(bt,ga,"p.p-dccon",vt),Ia=Rl(bt,Rl(bt,Rl(bt,ba,"dcl"),"vp"),"page"),xa=Rl(bt,Rl(bt,Rl(bt,ba,"dcc"),"vp"),"page"),Ca=e=>{let t=e.idx,l=e.title,r="dc"+t,n=Rl(bt,null,"package"),i=rt[ht]("#"+r);if(i)xa.replaceChild(n,i);else{xa.appendChild(n);let t=Rl("a",Ia,{href:"#"+r,[mt]:()=>{wa.focus(),er()}});l==d?Fl(t,"history"):Rl("img",t,{src:Mr(e.code)})}n.setAttribute("id",r),Rl(It,Rl(bt,n,"hd.r"),{[ft]:l});let a=Rl(bt,n,"flex.fr");for(let t of e.detail){let e=t.code,r=t.title,n=t.package_title;Rl("img",a,{loading:"lazy",src:Mr(e),[mt]:async()=>{let t=await Sr(e);if(DEBUG&&Tl(n,r,t),El()){Xr(t);let n=l;l==d&&(null!=Kr[e]||await Sr(e),n=Kr[e].package_title),wa.focus(),wa.value+=":"+n+", "+r+": "}else Nr(t,gl)}},"d")}},Aa=async e=>{await(async e=>{if("recent"==e&&await Zr(e,0),"icon"==e){let t=Math.min(await Zr(e,0),20);for(let l=1;t>=l;l++)await Zr(e,l)}})(e).catch(Tl)};nn["dccon-pk"]=e=>{for(let t in e){if(jr.includes(t))continue;let l=e[t];for(let e of l.detail)Kr[e.code]=e;jr.push(l.title)}};let La=!0,Ea=!1,Da=Rl("a",ma,{onmousedown:()=>(La=!La,La?(Wl(Ta,"f"),Vl(ba,vt)):(wa.focus(),Vl(Ta,"f"),Wl(ba,vt),Ea||(Ea=!0,Aa("recent"),Aa("icon"))),void Nt((()=>wa.focus())))},"d.b",kt),Ta=Fl(Da,"mood");DEBUG&&Tl("upload");let qa=Rl(bt,ma,"p.up.abs.vp.pv-vp",vt),Ja=Rl(bt,qa,"fr.page"),Ka=Rl("a",Ja,{[mt]:()=>Xa.click()},"pv.r.b.o-l");Fl(Ka,"add_photo_alternate"),Rl(It,Ka,{[ft]:Ye});let ja=null,Ga=!1,za=[],Ya=!1,Sa=()=>{null!==ja&&(ho?(Wl(ja.preview,vt),Ga?Wl(ja.preview,"up"):Vl(ja.preview,"up")):Vl(ja.preview,vt)),Fa[ft]=za.length,0==za.length?Vl(Fa,vt):Wl(Fa,vt),Ya&&El()?(Wl(qa,vt),Vl(Ra,"f")):(Vl(qa,vt),Wl(Ra,"f"))},Ua=(e=null)=>{Ya=null===e?!Ya:e,Sa()},$a=(e,t)=>{let l=Rl(bt,e,"pv.r"),r=Rl(bt,l,"image"),n=Rl("img",r),i=Rl(bt,l,"desc"),a=Rl(It,i,{[ft]:t.name},"file-name");return Rl(It,i,{[ft]:"("+Pl(t.size)+")"},"size"),{p:l,c:r,i:n,n:a}},Ba=e=>{let{p:t,c:l,i:r}=$a(Ja,e),n=Fl(l,"pending","pending.abs"),i=Fl(l,"warning","error.abs",vt),a=new FileReader;a.onload=()=>r.src=a.result,a.readAsDataURL(e);let{r:o,p:c}=ql(),s={preview:t,img:r,original:e.name,name:"",size:e.size,type:e.type,upload:!1,file:e,error:!1,num:0,url:"",close:async()=>{t.remove();for(let e=0;e<za.length;e++){let t=za[e];if(s===t){za.splice(e,1);break}}Sa(),s.upload?Jr(s.num):(await c.catch(Tl),s.error||Jr(s.num))},p:c};za.push(s);let u=Rl("a",t,"close.abs-tr.b");Fl(u,"delete","f"),u.onclick=()=>s.close();let p=(e,...l)=>{An(e),Tl(e,...l),s.error=!0,Vl(t,"error"),Wl(i,vt)};return qr(e).catch(Tl).then((e=>(Vl(n,vt),e?e.error?p(e.error,e):(s.upload=!0,Vl(t,"up"),s.name=e.name,s.url=e.url,s.num=e.file_temp_no,void o()):p(_e)))),s},Ma=(e=null)=>{if(null!==ja&&ja.close(),null===e)return ja?.preview.remove(),cn("zzal",""),Wl(po,vt),void(ja=null);ja=e,Vl(ja.preview,"o-f","z");for(let t=0;t<za.length;t++)za[t]===e&&za.splice(t,1);e.close=()=>{Ga=!0};let{p:t,i:l,n:r}=$a(lo,e);Vl(t,"up","o-f"),Vl(po,vt);let n=Rl("a",t,"close.abs-tr.b");Fl(n,"delete","f"),n.onclick=()=>{Cn({desc:ze,options:[{text:b,[mt]:e=>{Ma(null),t.remove(),e()},enter:!0},{text:k}]})};let i=()=>{l.src=e.img.src,r.innerText=e.name;let t=(e=>({name:e.name,size:e.size,type:e.type,url:e.url,src:e.img.src}))(e);cn("zzal",JSON.stringify(t))};e.upload?i():(async()=>{await e.p,i()})(),Sa()},Za=e=>e.size>2e7?An(me):ol?An(Ae):(Ba(e),Sa(),void Ua(!0)),Xa=Rl("input",null,{type:"file",accept:"image/*",multiple:"true",onchange:()=>{for(let e of Xa.files)Za(e)}}),Na=Rl("a",ma,{[mt]:()=>Ua()},"up.b.abs-tl",kt);Ln(Na,{text:Ie,top:!0}),ondragenter=async e=>{if(e.dataTransfer&&e.dataTransfer.files){let t=(e.dataTransfer.files.length>0?e.dataTransfer.files:e.dataTransfer.items)[0];if(!t.type||"image"!=t.type.split("/")[0])return;Vl(vn,"drag")}},vn.ondragenter=e=>{e.preventDefault()},vn.ondragover=e=>e.preventDefault(),vn.ondragleave=()=>{Nt((()=>Wl(vn,"drag")))},vn.ondrop=e=>{if(e.preventDefault(),Wl(vn,"drag"),e.dataTransfer.files){let t=!1;for(let l of e.dataTransfer.files)l.type&&"image"==l.type.split("/")[0]?Za(l):t=!0;t&&An(Ce)}},ct&&rt.addEventListener("paste",(async()=>{let e=await window.navigator.clipboard.read(),t=0;for(let l of e){Tl(l);let e=null;for(let t of l.types)if(e=t.match(/image\/(.+)$/),Tl(e),e)break;if(Tl(e),!e)continue;let r=await l.getType(e[0]),n=new File([r],`image_${t}.${e[1]}`);Za(n),t+=1}}));let Qa,Pa,Ra=Fl(Na,"add_circle"),Fa=Rl("span",Na,{[ft]:0},"cnt.abs-tr",vt);r=()=>{El()&&!ol?Wl(Na,kt):Vl(Na,kt)},DEBUG&&Tl("settings");let Ha=Rl(bt,ga,"p.p-settings",vt);Rl(It,Rl(bt,Ha,"hd"),{[ft]:X},"h"),Fl(Rl("a",Ha,{[mt]:()=>Qa()},"b.abs-tr"),"close");let Va=Rl("a",Ha,{[mt]:()=>Pa()},"b.abs-tl",vt);Fl(Va,"navigate_before");let Wa=Rl(bt,Ha),eo=Rl(bt,Wa,"opts"),to=Rl(bt,Wa,"opts",vt),lo=Rl(bt,Wa,"opts",vt),ro=Rl(bt,Wa,"opts",vt),no=eo;Pa=(e=eo)=>{Vl(no,vt),Wl(e,vt),no=e,e==eo?Vl(Va,vt):Wl(Va,vt)};let io=(e,t,l,r,n=!1,i=eo)=>{let a=n,o=Rl(bt,i,"opt");a&&Vl(o,"chk");let c=Rl(bt,o,"label.fr");return t&&Fl(c,t),Rl(It,c,{[ft]:e}),Fl(Rl(It,o,"value"),"check_small"),o.onclick=()=>cn(e,!a),nn[e]=e=>{a=e,a?(Vl(o,"chk"),l?.()):(Wl(o,"chk"),r?.())},on(e,n),o},ao=(e,t,l,r,n,i,a)=>io(e,t,(()=>Bl(l,r)),(()=>Bl(l,n)),i,a),oo=(e,t,l="")=>{let r=Rl(bt,eo,{[mt]:()=>Pa(t)},"opt.r"),n=Rl(bt,r,"label.fr");return l&&Fl(n,l),Rl(It,n,{[ft]:e}),Fl(r,"navigate_next","abs-r"),r};oo(tt,to,"block");let co=(e,t,l,r)=>{let n=Rl("a",t,{[mt]:()=>{let t=Cn({title:e,options:[],close:!0}).content,n=Rl(bt,t,"b-entry.fr"),i=()=>{Hl(n);let e=l?un():dn(Vt,ll),t=e[r].split("||");for(let a of t){if(""==a)continue;let t=Rl(bt,n,"entry.fr");Rl(It,t,{[ft]:'"'+a+'"'});let o=Rl("a",t,{[mt]:()=>{yn(e,r,a),l?gn(e):mn(e,Vt),i()}});Fl(o,"close","sml")}};i();let a=Rl(bt,t,"b-wrap.fr"),o=Rl("input",a,"nowrap"),c=Rl("a",a,{[mt]:()=>{if(!o.value)return;let e=l?un():dn(Vt,ll);_n(e,r,o.value),l?gn(e):mn(e,Vt),i(),o.value=""},[ft]:et},"sb");lr(o,c,!1,!0)}},"opt.r"),i=Rl(bt,n,"label.fr");Rl(It,i,{[ft]:e}),Fl(n,"navigate_next","abs-r")};Rl(bt,to,{[ft]:Ve},"opt.hr"),co(He,to,!0,"word"),co(Qe,to,!0,"id"),co(Pe,to,!0,"ip"),co(Re,to,!0,"nick");let so=Rl(bt,to,{[ft]:We},"opt.hr");co(He,to,!1,"word"),co(Qe,to,!1,"id"),co(Pe,to,!1,"ip"),co(Re,to,!1,"nick"),oo(re,lo);let uo=Rl("input",null,{type:"file",accept:"image/*",multiple:"true",onchange:()=>{if(0===uo.files.length)return;let e=Ba(uo.files[0]);Ma(e),ho||fo.click()}}),po=Rl("a",lo,{[mt]:()=>uo.click()},"pv.r.b.o-f");Fl(po,"add_photo_alternate"),Rl(It,po,{[ft]:Se});let ho=!1,fo=io(ne,null,(()=>{ho=!0,null!==ja&&Wl(ja.preview,vt)}),(()=>{ho=!1,null!==ja&&Vl(ja.preview,vt)}),!1,lo),go="",mo=Rl("a",lo,{[mt]:()=>{let e=Cn({title:ie,input:go,options:[{text:v,[mt]:t=>{go=e.input.value,cn("footer",go),t()}},{text:k}]}),t=e.input;Vl(t,"ft");let l=Rl(It,null,{[ft]:"- "+p,[mt]:()=>t.focus()},"footer-static");t.insertAdjacentElement("afterend",l)}},"opt.r");Rl(It,mo,{[ft]:ie},"label"),Fl(mo,"navigate_next","abs-r"),io(te,"dark_mode",(()=>Wl(nt,"light")),(()=>Vl(nt,"light")),!0);let _o=io(N,"splitscreen",(()=>{cl=!0,st&&!sn("mado")?Cn({title:v,desc:Je,options:[{text:b,[mt]:e=>{Fn(),cn("mado",!0),e()},enter:!0},{text:k,[mt]:e=>{_o.click(),e()}}]}):Fn()}),(()=>{cl=!1,Fn()}),!st);oo(le,ro);let yo=!0;io(H,null,(()=>yo=!0),(()=>yo=!1),!0),io(ee,null,(()=>{Vl(Fi,vt),Vl(Qi,vt)}),(()=>{al||(Wl(Fi,vt),Wl(Qi,vt))})),io(V,null,(()=>Wr(1)),(()=>Wr(0))),io(W,null,(()=>Vl(Dn,"co")),(()=>Wl(Dn,"co"))),io(ae,null,(()=>Wl(gi,"hn")),(()=>Vl(gi,"hn")),!1,ro),io(R,null,(()=>{Wl(gi,"hu"),a(!0)}),(()=>{Vl(gi,"hu"),a(!0)}),!0,ro),ao(Ee,null,"--cc","#fc5","var(--cf)",!0,ro),ao(Q,null,"--sb","smooth","auto",!0,ro);let wo="--fs";io(P,null,(()=>{Bl(wo,"15px"),a(!0)}),(()=>{Bl(wo,"13px"),a(!0)}),!1,ro),ao(F,null,"--ds","60px","80px",!1,ro),Rl(It,Ha,{[ft]:"version: "+VERSION},"version");let Oo=!0;Qa=()=>{Oo=!Oo,Oo?(Wl(bo,"f"),Vl(Ha,vt)):(Vl(bo,"f"),Wl(Ha,vt))};let vo=Rl(bt,ga,"fr.sc"),ko=Rl("a",vo,{[mt]:Qa},"b.gray"),bo=Fl(ko,"settings"),Io=Rl("a",vo,"sb",kt);Rl(It,Io,{[ft]:oe}),lr(wa,Io,!0),DEBUG&&Tl("funcs");let xo={},Co=async(e,t=!1)=>{if(!t&&null!=Ui[e])return Ui[e];let l={num:e,name:"",text:ce,write:"",esno:"",string:"",delId:"",delValue:"",vCurT:""},r=await xr(or(e)).catch(Tl),n=()=>l;fl=!!new RegExp(`id="code_${e}"`).test(r);let i=dr(r,bt,"write_div");if(!i)return n();let a=dr(r,bt,"gallview_head");if(!a)return n();let o=hr(a,bt,"gall_writer");if(!o)return n();l.name=_r(o,"data-nick"),l.write=i,l.text=((e,t)=>{let l=e.matchAll(/<(img|video)[^>]*src="[^">]+no=([0-9a-zA-Z]+)[^">]*"[^>]*>/g);for(let r of l){let l=r[0],n=l,i=r[2];if(DEBUG&&Tl("src",i),/class="d"/.test(l))continue;let a=l.match(/class="([^"]+)"/);n=a?n.r(a[0],`class="${a[1]} img"`):n.r(">","")+' class="img">';let o=l.match(/on[Cc]lick="[^"]+no=([0-9a-zA-Z]+)[^"]*"/);n=o?n.r(o[0],`onclick="window.postMessage(JSON.stringify({type:'${Ot}',src:'${Vr(o[1])}',id:'${t}'}))" data-osrc="${Vr(o[1])}"`):n.r(">","")+` onclick="window.postMessage(JSON.stringify({type:'${Ot}',src:'${Vr(i)}',id:'${t}'}))" data-osrc="${Vr(i)}" draggable="false">`,e=e.r(l,n)}return e})(Hr(Rr(i).r(/(\r|\t)/g,"").r(/[ ]{2,}/g," ")),"pc-"+e);let c=kr(r,"e_s_n_o");c&&(l.esno=c),l.string=sr(r),Ui[e]=l;let s={};if(br(r,"_cmt_del_form_",s))for(let e in s)l.delId=e,l.delValue=s[e];let u=kr(r,"v_cur_t");u&&(l.vCurT=u);let p={cur_t:"",check_6:"",check_7:"",check_8:"",check_9:"",check_10:"",recommend:"0",user_ip:"",t_vch2:"",t_vch2_chk:"",service_code:""};return en(r,p),p.service_code=ur(p.service_code,l.string),xo[e]=p,n()},Ao=async(e,t,l)=>{let r,n=await Dr(e,nr()+"comment/",t).catch(Tl);if(!n)return!1;try{r=JSON.parse(n)}catch(e){return Tl(e,n),!1}let i=r.total_cnt;l.count=i;let a=r.comments;if(!a||!a.length)return!1;for(let e of a){let t=Xt(e.no);if(0==t)continue;let r={num:t,id:"",ip:"",name:"",img:"",fix:!1,text:"",target:0};if(null!=l.comments[t])continue;l.comments[t]=r,r.id=e.user_id,r.ip=e.ip,r.name=e.name,r.text=Hr(Rr(e.memo).r(/\n/g,"<br />"));let n=e.c_no;n&&(r.target=Xt(n));let i=e.gallog_icon.match(/\<img src='([^']+)'/);if(i){let e=i[1];r.img=e,r.fix=yr(e)}}return!0},Lo=async e=>{let{esno:t}=await Co(e).catch(Tl),l=$i[e],r={count:l,num:0,comments:{}};null!=Mi[e]&&(r=Mi[e]);let n={id:Vt,no:e,cmt_id:Vt,cmt_no:e,focus_cno:"",focus_pno:"",e_s_n_o:t,comment_page:1,sort:"D",prevCnt:"0",board_type:"",_GALLTYPE_:Wt},i=!0;for(;i;)i=await Ao(e,n,r).catch(Tl),n.comment_page++;return l!=r.count&&Bi[e](r.count,!0),Mi[e]=r,r},Eo=[],Do=async(e,t=!1)=>{if(0==e.length)return;bl?kl&&Xi({title:de}):t=!0,e=e.sort(((e,t)=>e.num-t.num));let l=0;for(let r of e)Eo.includes(r.num)||(await Xi(r).catch(Tl),r.count&&Bi[r.num]?.(r.count,t)),l=Math.max(l,r.num);wl=Math.max(wl,l),Ll&&Ll.postMessage({type:"ln",n:wl}),bl||(Xi({title:pe}),bl=!0,ol&&Xi({title:ke})),kl=!1},To=()=>{let e,t,l,r,n,i,a,o,c,s,u,p,d,h,f,g;try{e=_DEBUG,t=_URL,l=_TEXT,r={},n=(e,t)=>{r[e]=t,self.postMessage({type:"cc",n:e,c:t})},i=async e=>self.postMessage({type:"pd",d:e}),a=_IT,o=_IH,c=_OH,s=_AT,u=_A,p=_TF,d=_SS,h=_SN,f=Number.parseInt,g=()=>_LN}catch{e=Tl,t=ir(),l=xr,r=$i,n=(e,t)=>Bi[e]?.(t,kl),i=Do,a=gr,o=dr,c=hr,s=mr,u=_r,p=yr,d=ue,h=se,f=Xt,g=()=>wl}let m=e=>e.replace(/&amp;/g,"&").replace(/&nbsp;/g," ").replace(/&#035;/g,"#").replace(/&#039;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');return{_UL:async()=>{let _=await l(t);if(_)try{_=_.replace(/(\n|\r|\t)/g,"");let e=[],t=_.matchAll(/<tr[^>]*class="[^"]*us-post[^"]*"[^>]*data-no="([^"]*)".+?<\/tr>/g);if(!t)return;for(let l of t){let t=l[0],i={num:0,subject:"",title:"",nickname:"",id:"",ip:"",date:0,img:"",fix:!1,count:0},_=f(l[1]);i.num=_;let y=t.match(/<span[^>]*class="[^"]*reply_num[^>]*"[^>]*>\[([0-9]+)\]<\/span>/),w=r[_]??0,O=0;if(y&&(O=f(y[1]),O&&(i.count=O)),_<=g()){O!=w&&n(_,O);continue}let v=a(t,"td","gall_tit");y&&(v=v.slice(0,v.length-y[1].length-2)),i.title=m(v);let k=o(t,"td","gall_num");if(k==d||k==h||"AD"==k)continue;let b=a(t,"td","gall_subject");if(i.subject=m(b),b==d||b==h||"AD"==b)continue;let I=c(t,"td","gall_writer");if(I){s(I,"data-nick",i,"nickname"),s(I,"data-uid",i,"id"),s(I,"data-ip",i,"ip");let e=I.match(/<img[^>]*src=["']([^"']+)["']/);if(e){let t=e[1];i.img=t,i.fix=p(t)}}let x=c(t,"td","gall_date"),C=u(x,"title");null!==C&&(i.date=Date.parse(C)),e.push(i)}await i(e)}catch(t){e(t)}}}},{_UL:qo}=To(),Jo=()=>{let e=async()=>{let t,l,r,n;try{t=_UL,l=_IV,r=()=>{},n=_DEBUG}catch{l=yl,t=qo,r=e=>Al=e,n=Tl}await t().catch((e=>{n(e),postMessage({type:"err"})})),r(setTimeout(e,l))};return{_UC:e}},{_UC:Ko}=Jo(),jo=(...e)=>{if(Tl("init update",...e),kl=!0,ot){Ll&&Ll.terminate();let e=new Blob([`let _URL='${ir()}';`,`let _IV=${yl};`,`let _LN=${wl};`,`let _SS='${ue}';`,`let _SN='${se}';`,`let{_IH,_OH,_IT,_AT,_A,_TF,_DEBUG}=(${pr.toString()})();`,`let{_TEXT}=(${Ir.toString()})();`,`let{_UL}=(${To.toString()})();`,`let{_UC}=(${Jo.toString()})();`,"self.onmessage=async(e)=>{switch(e.data.type){case'iv':_IV=e.data.iv;break;case'ln':_LN=e.data.n;break;}};","_UC();"],{type:"text/javascript"}),t=URL.createObjectURL(e);Ll=new Worker(t),Ll.onerror=(...e)=>{Tl(...e),jo("error",...e)},Ll.onmessage=async e=>{let t=e.data;if(t&&t.type){if("pd"==t.type)return await Do(t.d);if("cc"==t.type)return Bi[t.n]?.(t.c,kl);if("err"==t.type)return jo("worker err")}}}else Al&&clearTimeout(Al),Ko()};jo();let Go={id:"",_GALLTYPE_:"",gallery_no:0,r_key:"",upload_status:"",clickbutton:"",user_ip:"",block_key:"",tempIdx:"",headtext:"",use_headtext:"",poll:"",service_code:"",use_html:"",subject:"",adult_article_yn:"N",adult_auth_yn:"N",ci_t:void 0,mode:"W",movieIdx:"",series_title:"[]",series_data:"",headTail:'""'};il&&(Go.fix="");let zo="",Yo=(e=!0)=>{!ol&&e&&bl&&Xi({title:ke}),ol=e,e?(El()&&(Vl(wa,kt),Vl(Na,kt),Vl(Da,kt),Vl(Io,kt)),al||Vl(Ni,vt)):(Wl(wa,kt),Wl(Na,kt),Wl(Da,kt),Wl(Io,kt),al||Wl(Ni,vt))};Ri=async()=>{let e=await xr(ar()).catch(Tl);if(!/id="write"/.test(e))return Yo();if(Yo(!1),en(e,Go),u=sr(e),hl=/id="code"/.test(e),il){Go.headtext=0;let t=kr(e,al?"nickname":"name");Cl=t||""}na(),ra(),a(!0)};let So=e=>"false||"+e,Uo=(e,t,l)=>`<img class="written_dccon" src="${e}" conalt="${t}" alt="${t}" con_alt="${t}" title="${t}" detail="${l}">`,$o=0,Bo=async(e,t=!0)=>{let l=`<p><a href="${e}" target="_blank">${e}</a></p>`,r=await Lr(zt+"api/ogp",{url:e});if(!r)return l;let n=JSON.parse(r);if(!n.result)return l;let i=`{{_OG_START::${e}^#^${n.og_title}^#^${n.og_description}^#^${n.og_image}::OG_END_}}`;return t&&(i=`<p><span class="og-url" style="color:#3b4890">${e}</span></p><p></p>`+i),i},Mo=async(e,t)=>{Go.subject=Pt(e);let l={};if(!al){let e=ia(),t=oa();if(0==e.length)return So(f);if(t.length<2)return So(g);l.name=e,l.password=t}if(hl){let e=ca();if(0==e.length)return So(m);l.kcaptcha_code=e}let r=Ft(),n=r-$o;if(n<2e3){let e=2e3-n;$o=r+e,await(e=>{let{r:t,p:l}=ql();return Qt(t,e),l})(e)}else $o=r;if(zo=await Lr("/block/block/",Go,l).catch(Tl),!zo)return So(fe);Go.service_code=ur(Go.service_code);let i={block_key:zo,memo:"",code:hl?ca():void 0,bgm:"0"},a="";0!==za.length|(ho&&null!==ja&&!Ga)&&(a+=h),ho&&null!==ja&&!Ga&&(a+=`<img src="${ja.url}"/>`+h);for(let e=0;e<za.length;e++){let t=za[e];if(!t.upload)return So(we);a+=`<img src="${t.url}" class="txc-image "/>`+h,i["file_write["+e+"][file_no]"]=t.num}let o="";if(yo&&Pn.length)for(let e=0;e<Pn.length;e++){let t,l,r=Pn[e],n=r.match(Kt),i=r.match(qt);if(n){if(t=n[2],l="https://youtu.be/"+t,0==e){o+=`<p><span class="og-url" style="color:#3b4890" <div=""></span></p><div class="yt_movie"><embed src="https://www.youtube.com/v/${t}?version=3" type="application/x-shockwave-flash" width="560" height="315" allowfullscreen="true"></div><a class="yt_link" href="${l}" target="_blank">${l}</a></div>`,o+=await Bo(l,!1);continue}}else i?(t=i[2],l="https://www.twitch.tv/"+t):l=r;o+=await Bo(l)}o&&(o+=h);let c="";for(let t of e.matchAll(Dt)){let e=t[1],l=t[2],r=Br(e,l);if(!r)continue;let n=$r(e,l);n&&n.buy&&(c+=Uo(r,l,n.idx))}c&&(c+=h);for(let e of t.matchAll(Dt)){let l=e[0],r=e[1],n=e[2],i=Br(r,n);if(!i)continue;let a=$r(r,n);a&&a.buy&&(t=t.r(l,Uo(i,n,a.idx)))}return i.memo=Pt(a+o+h+c+t),await Xl(Lr,[Ut,Go,l],i,"comment_submit")};Io.onclick=async()=>{if(!wa.value)return;let e=wa.value??"";if(wa.value="",wa.oninput(),0==gl){let{r:t,p:l}=ql();if(0!==za.length){let e=!1,r=!1;for(let t of za)t.upload||(e=!0),t.error&&(r=!0);if(r){if(Cn({title:Oe,desc:ve,options:[{text:b,[mt]:e=>{t(!0),e()},enter:!0},{text:k,[mt]:e=>{t(!1),e()}}]}),!await l.catch(Tl))return}else if(e)return An(we)}let r=e.split("\n");e=r[0];let n=h;for(let e=1;e<r.length;e++)n+=`<p>${r[e]}</p>`;if(""!==go){r=go.split("\n");for(let e of r)n+=`<p style="color:#ABABAB;">${e}</p>`}n+=`<p style="color:#ABABAB;">- ${p} ${Yl(20)}</p>`,(e=>{Qt(Ri,500);let t=Sl(e);if(1==t.length)return Tl(e),An(he);if("false"==t[0])return An(t[1]),Tl(e);let l=Xt(t[1].trim());Eo.push(l),Xi({num:l,nickname:aa(),id:al?ul:"",ip:al?"":$l(Go.user_ip),title:Go.subject,img:pl,fix:dl,my:!0}),Ga=!1;for(let e=0;e<za.length;e++)za[e].close();za.length=0,Ua(!1)})(await Mo(e,n).catch(Tl))}else _l=Yl(8),((e,t)=>{Qt(na,500);let l=Sl(e);l.length<2?(Tl(e),An(he)):"false"==l[0]?(Tl(e),An(l[1])):(i(0),Bi[t](-1,!0))})(await(async(e,t,l=0)=>{let r=xo[e];if(!r)return 0;let n={};if(l&&(n.c_no=l),al)n.name=sl;else{if(Cl)n.nickname=Cl;else{let e=ia();if(0==e.length)return So(f);n.name=e}let e=oa();if(e.length<2)return So(g);n.password=e}if(fl){let e=ca();if(0==e.length)return So(m);n.code=e}n.memo=Pt(t);let i={id:Vt,no:e,c_gall_id:Vt,c_gall_no:e,[xt]:"",_GALLTYPE_:Wt,headTail:'""'},a=await Xl(Dr,[e,$t,r,n],i,"comment_submit");try{let e=Xt(a);if(e)return"true||"+e}catch{Tl(a)}return a})(gl,e+_l,ml).catch(Tl),gl);st&&wa.focus()},(()=>{let e=at?.getItem(_t)??"";if(e){rn=JSON.parse(e);for(let e in rn)on(e,rn[e])}})(),0!==Pn.length&&Gn(!1);let Zo=sn("version")??"";if("undefined"!=typeof VERSION){let e=e=>{let t=e.split(".");return t[0]+"."+t[1]};if(e(Zo)!==e(VERSION)){let e=Cn({title:Ue+": "+VERSION,desc:lt+'<a href="https://joh1ah.github.io/dclivechat/change.log" target="_blank">'+$e+"</a>",html:!0});En(e.content,[{text:Me,icon:"delete"},{hr:!0},{text:C,icon:"open_in_new"},{text:Ne},{hr:!0},{text:Qe},{text:Re}]);let t=e.content.oncontextmenu({preventDefault:()=>{},clientX:0,clientY:0});xn=null,(Xo=t).parentNode.removeChild(Xo),e.content.appendChild(t),t.style.position="relative",t.style.marginTop="1em"}}var Xo;cn("version",VERSION),(()=>{let e=sn("zzal");if(null!==e&&""!==e)try{let t=(e=>{let{p:t,i:l}=$a(Ja,e);Vl(t,"up"),l.src=e.src;let r={preview:t,img:l,original:e.name,name:e.name,size:e.size,type:e.type,upload:!0,file:null,error:!1,num:null,url:e.url,close:()=>{t.remove();for(let t=0;t<za.length;t++){let l=za[t];if(e===l){za.splice(t,1);break}}Sa()}},n=Rl("a",t,"close.abs-tr.b");return Fl(n,"delete","f"),n.onclick=()=>r.close(),r})(JSON.parse(e));Ma(t)}catch{Ma(null)}})(),go=sn("footer")??"",Nt((()=>Wl(nt,vt))),Tl("INIT done")})().catch((e=>console.log(e)));