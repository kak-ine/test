(async()=>{String.prototype.r=function(e,t){return this.replace(e,t)};let e=new TextDecoder;function t(t){let l=atob(t.r(/-/g,"+").r(/_/g,"/").r(/\./g,"=")),r=new Uint8Array(l.length);for(let e=0;e<r.length;e++)r[e]=l.charCodeAt(e);return e.decode(r)}let l,r,i,a,o,c,s,u=t("7LWc6re8IOyCrOyaqQ.."),p=t("PHA-PGJyPjwvcD4."),d=t("64uJ64Sk7J6E7J2EIOyeheugpe2VmOyEuOyalC4."),h=t("67mE67CA67KI7Zi466W8IDLsnpDrpqwg7J207IOBIOyeheugpe2VmOyEuOyalC4."),f=t("64-E67CwIOuwqeyngCDsvZTrk5zrpbwg7J6F66Cl7ZWY7IS47JqULg.."),g=t("7J20IOq4sOuKpeydgCBEQ-yduOyCrOydtOuTnCDqsKTrn6zrpqzsl5DshJzrp4wg7IKs7Jqp7ZWgIOyImCDsnojsirXri4jri6Qu"),m=t("7J20IOq4sOuKpeydgCDquIAg66qp66GdIO2OmOydtOyngOyXkOyEnOunjCDsgqzsmqntlaAg7IiYIOyeiOyKteuLiOuLpC4."),_=t("UEPrsoTsoIQg7Y6Y7J207KeA7JeQ7IScIOuLpOyLnCDsi5zrj4TtlbTso7zshLjsmpQu"),y=t("66Gc6re47JWE7JuD"),w=t("7ZmV7J24"),O=t("7Leo7IaM"),v=t("64Sk"),k=t("7KO87IaM6rCAIOyYrOuwlOultOyngCDslYrsirXri4jri6Qu"),b=t("7J20IOuwqeyGoeydhCDsi5zssq3tlZjsi5zqsqDsirXri4jquYw_"),I=t("7IOIIOywveyXkOyEnCDsl7TquLA."),x=t("7IOd67Cp7IahIOyjvOyGjA.."),C=t("66mU7Iuc7KeAIOuztOuCtOq4sA.."),A=t("64u16riAIOyeheugpQ.."),L=t("64yT6riAIOyeheugpQ.."),D=t("7IOd67Cp7IahIOyxhO2MhQ.."),E=t("7Iqk7YGs66Gk7ZW07IScIOyxhO2MheydtCDrqYjst4TsirXri4jri6Q."),T=t("7IOIIOuplOyLnOyngCDrs7TquLA."),q=t("67O06riw"),J=t("MjDqsJwg7J207IOB"),K=t("6rCc"),j=t("7IOIIOuplOyLnOyngCA."),G=t("64uJ64Sk7J6E"),z=t("67mE67CA67KI7Zi4"),Y=t("7L2U65OcIOyeheugpQ.."),S=t("7JeQ6rKMIOuLteq4gA.."),U=t("7JeQ6rKMIOuMk-q4gA.."),$=t("64yT6riAIOyTsOq4sA.."),B=t("7IOIIOuMk-q4gCDsk7DripQg7KSR"),Z=(t("66Gc65Sp7KSR7J6F64uI64ukLg.."),t("7LGE7YyFIOyEpOyglQ..")),M=t("64uk7KSRIO2ZlOuptCDsgqzsmqkgKOuniOuPhCk."),X=t("67aA65Oc65-s7Jq0IOyKpO2BrOuhpCDslaDri4jrqZTsnbTshZg."),N=t("7Y-w7Yq4IO2BrOq4sCDtmZXrjIA."),Q=t("67CY6rOg64uJIOyVhOydtOuUlCDtkZzsi5w."),P=t("65SU7Iuc7L2YIO2BrOq4sCDspITsnbTquLA."),R=t("6riAIOuCtOyaqeyXkCDrp4Htgawg7LaU6rCA"),F=t("7Ken7J2AIOyxhO2MhSDsp4Dsl7Dsi5zqsIQ."),H=t("67Cp7IahIOyXhuydtCDssYTtjIXssL3rp4wg7IKs7Jqp"),V=t("7Jyg64-ZIOuhnOq3uOyduCDsiKjquLDquLA."),W=t("64uk7YGsIOuqqOuTnA.."),ee=t("7LGE7YyFIO2RnOyLnCDrsKnrspU."),te=t("7J6Q64-Z7Kek67CpIOuwjyDqvKzrpqzrp5A."),le=t("7J6Q64-Z7Kek67CpIOyCrOyaqQ.."),re=t("6rys66as66eQIOyImOyglQ.."),ne=t("64uJ64Sk7J6EIOyVhOydtOy9mCDtkZzsi5w."),ie=t("7LGE7YyF"),ae=t("7IKt7KCc65CY7JeI6rGw64KYIOyhtOyerO2VmOyngCDslYrripQg6rKM7Iuc66y87J6F64uI64ukLg.."),oe=t("6rO17KeA"),ce=t("7ISk66y4"),se=t("7LGE7YyF67Cp7JeQIOyYpOyLoCDqsoPsnYQg7ZmY7JiB7ZWp64uI64ukIQ.."),ue=t("7LGE7YyF7LC97JeQIOuLpOyLnCDsl7DqsrDtlojsirXri4jri6Qu"),pe=t("7JWMIOyImCDsl4bripQg7Jik66WY"),de=t("7JWMIOyImCDsl4bripQg7Jik66WYIChibG9ja19rZXkp"),he=t("7J6Y66q765CcIOyalOyyreyeheuLiOuLpC4."),fe=t("7J2066-47KeA6rCAIOuEiOustCDtgb3ri4jri6Qu"),ge=t("7J2066-47KeAIOyXheuhnOuTnOyXkCDsi6TtjKjtlojsirXri4jri6Qu"),me=t("7J2066-47KeAIOyCreygnOyXkCDsi6TtjKjtlojsirXri4jri6Qu"),_e=t("7JWE7KeBIOyXheuhnOuTnCDspJHsnbgg7J2066-47KeA6rCAIOyeiOyKteuLiOuLpC4."),ye=t("7J2066-47KeAIOyXhuydtCDsmKzrpqzsi5zqsqDsirXri4jquYw_"),we=t("7JeF66Gc65Oc7JeQIOyLpO2MqO2VnCDsnbTrr7jsp4DqsIAg7J6I7Iq164uI64ukLg.."),Oe=t("7LGE7YyF7J20IOu5hO2ZnOyEse2ZlOuQmOyXiOyKteuLiOuLpC4."),ve=t("7J2066-4IOyLpO2WieykkeyeheuLiOuLpC4."),ke=t("7J2066-47KeAIOyyqOu2gA.."),be=t("65Oc656Y6re4IOyVpCDrk5zroa3snLzroZwg7J2066-47KeAIOyYrOumrOq4sA.."),Ie=t("7J2066-47KeA66eMIOyYrOumtCDsiJgg7J6I7Iq164uI64ukLg.."),xe=t("7LGE7YyF7J20IOu5hO2ZnOyEse2ZlOuQnCDqsKTrn6zrpqzsnoXri4jri6Qu"),Ce=t("4oCA4oCB4oCE4oCF4oCG4oCH4oCI4oCJ4oCK"),Ae=t("64yT6riA7IiYIO2VmOydtOudvOydtO2KuA.."),Le=t("7JiB7IOBIOy2lOqwgA.."),De=t("67Cw7LmYIOuwlOq-uOq4sA.."),Ee=t("67Cw7LmYIOyZhOujjCE."),Te=t("66qo67CU7J28IO2ZmOqyveyXkOyEnOuKlCDqtozsnqXtlZjsp4Ag7JWK7Iq164uI64ukLgrqt7jrnpjrj4Qg7IKs7Jqp7ZWY7Iuc6rKg7Iq164uI6rmMPw.."),qe=t("7KCE7LK0IOuLq-q4sA.."),Je=t("64uk7Jq066Gc65Oc"),Ke=t("64ur6riw"),je=t("7J6Q64-Z7Kek67CpIOydtOuvuOyngOulvCDsgq3soJztlZjsi5zqsqDsirXri4jquYw_"),Ge=t("7J2066-47KeAIOyXheuhnOuTnA.."),ze=t("7J6Q64-Z7Kek67CpIOyXheuhnOuTnA.."),Ye=t("67KE7KCEIOyXheuNsOydtO2KuOuQqA.."),Se=t("7KCE7LK0IOuzgOqyveyCrO2VrSDrs7TquLA."),Ue=t("6rWs66ek7ZWY7KeAIOyViuydgCDrlJTsi5zsvZjsnoXri4jri6Qu"),$e=t("7IKt7KCc"),Be=t("7IKt7KCc7ZWY7Iuc6rKg7Iq164uI6rmMPw.."),Ze=t("7IKt7KCc65CcIOqyjOyLnOusvOydgCDrs7XqtaztlaAg7IiYIOyXhuyKteuLiOuLpC4."),Me=t("VVJMIOuzteyCrA.."),Xe=t("SUQg7LCo64uo"),Ne=t("SVAg7LCo64uo"),Qe=t("64uJ64Sk7J6EIOywqOuLqA.."),Pe=t("64uk7J2MIOydtOyaqeyekOulvCDssKjri6jtlZjsi5zqsqDsirXri4jquYw_"),Re=t("7YKk7JuM65OcIOywqOuLqA.."),Fe=t("7KCE7LK0IOywqOuLqA.."),He=t("6rCk65-s66asIOywqOuLqA.."),Ve=t("7LaU6rCA"),We=t("7LCo64uoIOyEpOyglQ.."),et=t("7J207KCcIOq4gOydhCDsmKTrpbjsqr0g7YG066at7ZWY66m0PGJyPuuLpOydjCDrqZTribTrpbwg7IKs7Jqp7ZWgIOyImCDsnojsirXri4jri6Qh"),tt=document,lt=tt.body,rt=tt.head,nt=localStorage??null,it=window.Worker&&!0,at=window.navigator.clipboard.read&&!0,ot=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),ct=ot&&/Safari/i.test(navigator.userAgent),st=[5e3,3e3,1e3],ut="getElementsByClassName",pt="querySelector",dt="innerText",ht="placeholder",ft="onclick",gt="dclivechat",mt="onopenlink",_t="ondcconerror",yt="onimageclick",wt="hidden",Ot="disabled",vt="div",kt="span",bt="g-recaptcha-response",It="6Lc-Fr0UAAAAAOdqLYqPy53MxlRMIXpNXFvBliwI",xt="subdirectory_arrow_right",Ct="arrow_downward",At=(e,t=!0)=>(e=e.r("?","\\?"),t?new RegExp(e,"g"):new RegExp(e)),Lt=/:([^,:]+), ([^,:]+):/g,Dt=/dccon\.php\?no=([a-z0-9]+)/,Et=/twitch.tv\/(\?channel=)?([A-Za-z0-9_-]+)/,Tt=/href="(https?:\/\/)?(www.)?twitch.tv\/([^"]+)"/g,qt=/youtu(.be\/|be.com\/watch\?v=|be.com\/v\/|be.com\/shorts\/|be.com\/live\/|be.com\/embed\/)([A-Za-z0-9_-]+)/,Jt=/href="(https?:\/\/)?(www.)?youtu(.be\/|be.com\/watch\?v=|be.com\/v\/|be.com\/shorts\/|be.com\/live\/)([^"]+)"/g,Kt="https://",jt=Kt+"gall.dcinside.com/",Gt=Kt+"github.com/Joh1ah/dclivechat",zt="/board/forms",Yt=zt+"/article_submit",St=zt+"/comment_submit",Ut="/dccon/insert_icon",$t=zt+"/delete_submit",Bt=zt+"/delete_password_submit",Zt=Number.parseInt,Mt=requestAnimationFrame,Xt=setTimeout,Nt=encodeURIComponent,Qt=String.fromCharCode,Pt=Date.now,Rt=Pt(),Ft="",Ht="",Vt="",Wt="",el="",tl=!1,ll=!0,rl=!1,nl=!1,il=!1,al=!0,ol="",cl="",sl="",ul=!1,pl=!1,dl=!1,hl=0,fl=0,gl="",ml=st[0],_l=0,yl=0,wl=!0,Ol=!0,vl=!1,kl=99999,bl=!0,Il="",xl=null,Cl=null,Al=()=>0==hl,Ll=()=>Al()?pl:dl,Dl=(...e)=>{let t="["+((Pt()-Rt)/1e3).toFixed(2)+"]";if(console.log(t,...e),DEBUG&&s){for(let l of e)t+=void 0===l?" undefined":" "+(l.toString?.()??"");Pl("p",s,{[dt]:t})}},El=()=>{let e,t=new Promise((t=>e=t));return{r:e,p:t}},Tl=(e,t)=>{let l=t-e+1,r=Math.random()*l;return Math.min(e+Math.floor(r),t)};let ql=(e,t)=>{let l=e.indexOf(t);-1!=l&&e.splice(l,1)},Jl=new TextEncoder,Kl=async e=>{let t=Jl.encode(e),l=function(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}(await crypto.subtle.digest("SHA-256",t).catch(Dl));return"#"+l.slice(0,6)};let jl,Gl=Ce.split(""),zl=e=>{let t="";for(let l=0;l<e;l++)t+=Gl[Tl(0,Gl.length-1)];return t},Yl=e=>e.split("||"),Sl=e=>{let t,l,r=tt.cookie.split(";");for(let n=0;n<r.length;n++)if(t=r[n].substring(0,r[n].indexOf("=")),l=r[n].substring(r[n].indexOf("=")+1),t=t.r(/^\s+|\s+$/g,""),t==e)return l;return"undefined"},Ul=e=>{let t=e.split(".");return t[0]+"."+t[1]},$l=(e,t)=>((e,t,l)=>e.style.setProperty(t,l))(tt.documentElement,e,t),Bl=async()=>{let{r:e,p:t}=El();return Pl("script",lt,{onload:()=>{if("undefined"==typeof grecaptcha)return Dl("recaptcha is undefined");Dl("recaptcha v3 loaded"),e()},type:"text/javascript",src:Kt+"www.google.com/recaptcha/api.js?render="+It}),await t},Zl=async(e,t,l)=>{if("v3"==e)return t["g-recaptcha-token"]=await(async e=>{"undefined"==typeof grecaptcha&&await Bl();let{r:t,p:l}=El();return grecaptcha.ready((()=>grecaptcha.execute(It,{action:e}).then(t).catch((e=>{Dl(e),t("")})))),await l})(l);Dl("recaptcha",e,"is not supported")},Ml=async(e,t,l,r)=>{let n,i=0,a=async()=>{if(i>1)return n;if(i+=1,n=await e(...t,l),!n)return Yo(he);let o=Yl(n);if("false"==o[0]){if(1==o.length)return Yo(n);if("captcha"==o[1])return await Zl(o[2],l,r),await a()}return n};return await a()},Xl=1024,Nl="B.KB.MB.GB.TB.PB".split("."),Ql=e=>{let t=0,l=1,r=Xl;for(;t<Nl.length;){if(e<r){let r=e/l,n=10,i=2;for(;;){if(r<n)return r.toFixed(i)+Nl[t];n*=10}}l*=Xl,r*=Xl,t++}},Pl=(e,t,l,...r)=>{let n=tt.createElement(e);if(l)if("object"==typeof l)for(let e in l)n[e]=l[e];else"string"==typeof l&&r.push(l);for(let e of r)n.classList.add(...e.split("."));return t&&t.appendChild&&t.appendChild(n),n},Rl=(e,t,...l)=>Pl(kt,e,{[dt]:t},"material-symbols-outlined.icon",...l),Fl=e=>{for(;e.lastChild;)e.removeChild(e.lastChild)},Hl=(e,...t)=>(e.classList.add(...t),e),Vl=(e,...t)=>(e.classList.remove(...t),e),Wl=()=>scrollTo(0,0),er=!1,tr=(e,t,l=!1,r=!1)=>{e.onkeypress=n=>{!r&&er||"Enter"==n.key&&(DEBUG&&Dl(n),ot&&l||!ot&&l&&n.shiftKey||(n.preventDefault(),t.click(),e.oninput?.()))}},lr=()=>jt+(ll?"mgallery/":rl?"mini/":"")+"board/",rr=()=>jt+"board/",nr=()=>lr()+"lists?id="+Ft,ir=()=>lr()+"write/?id="+Ft,ar=e=>lr()+"view/?id="+Ft+"&no="+e,or=(...e)=>{let t="";for(let l of e)for(let e in l){let r=l[e];null==r&&(r="undefined"),t+="&"+e+"="+r}return t.substring(1)},cr=e=>{let t=e.match(/var _r = _d\('([A-Za-z0-9+=\/]+)'\)/);return t?(e=>{let t,l,r,n,i,a,o,c="yL/M=zNa0bcPQdReSfTgUhViWjXkYIZmnpo+qArOBslCt2D3uE4Fv5G6wH178xJ9K",s="",u=0;for(e=e.r(/[^A-Za-z0-9+/=]/g,"");u<e.length;)n=c.indexOf(e.charAt(u++)),i=c.indexOf(e.charAt(u++)),a=c.indexOf(e.charAt(u++)),o=c.indexOf(e.charAt(u++)),t=n<<2|i>>4,l=(15&i)<<4|a>>2,r=(3&a)<<6|o,s+=Qt(t),64!=a&&(s+=Qt(l)),64!=o&&(s+=Qt(r));return s})(t[1]):""},sr=(e,t)=>{let l=(t=(e=>{let t=Zt(e.substring(0,1));return t=t>5?t-5:t+4,e.r(/^./,t)})(t??jl)).split(","),r="";for(n=0;n<l.length;n++)r+=Qt(2*(l[n]-n-1)/(13-n-1));return e.r(/(.{10})$/,r)},ur=()=>{let e;try{e=Dl}catch{e=console.log}let t={},l=(e,t,l)=>{let n=r(e,t,l);return n?n[0]:""},r=(e,l,r)=>{let n,i=l+r;if(void 0!==t[i])n=t[i];else{n=new RegExp(`<${l}[^>]*class=["'][^"]*${r}[^"]*["'][^>]*(/?)>`,"g"),t[i]=n}let a=e.matchAll(n);if(!a)return null;let o=[];for(match of a){if(match[1]){o.push([match[0],""]);continue}let t=match.index,r=0,n=e.substring(t),i=0,a=n.matchAll(new RegExp(`<(/?)${l}[^>]*(/?)>`,"g"));for(let e of a)if(e[1]){if(i-=1,0==i){t=e.index,r=e[0].length;break}}else e[2]||(i+=1);o.push([n.substring(0,t+r),n.substring(match[0].length,t)])}return o},n=(e,t,r)=>{let n=l(e,t,r);return n?n[1]:""},i=e=>{let t="";for(let l of e.matchAll(/(>|$)(.*?)(<|^)/g))t+=l[2].trim();return t},a={},o=(e,t)=>{let l;void 0!==a[t]?l=a[t]:(l=new RegExp(`${t}="([^"]+)"`),a[t]=l);let r=e.match(l);return r?r[1]:null};return{_IH:n,_OH:(e,t,r)=>{let n=l(e,t,r);return n?n[0]:""},_OHA:(e,t,l)=>{let n=[],i=r(e,t,l);if(!i)return"";for(let e of i)n.push(e[0]);return n},_IT:(e,t,l)=>{let r=n(e,t,l);return r?i(r):""},_AT:(e,t,l,r)=>{let n=o(e,t);null!=n&&(l[r]=n)},_A:o,_TF:e=>/fix/.test(e),_DEBUG:e,_IO:i}},{_IH:pr,_OH:dr,_OHA:hr,_IT:fr,_AT:gr,_A:mr,_TF:_r,_DEBUG:yr,_IO:wr}=ur(),Or={},vr=(e,t)=>{let l;Or[t]?l=Or[t]:(l=new RegExp(`<[^>]+(id|name)=["']${t}["'][^>]+value=["']([^"']+)["']`),Or[t]=l);let r=e.match(l);return r?r[2]:""},kr=(e,t,l)=>{let r=new RegExp(`<form[^>]+id=["']${t}["'][^>]*>.*?</form>`),n=e.match(r);return!!n&&(en(n[0],l),!0)},br=()=>{let e;try{e=_DEBUG}catch{e=Dl}return{_TEXT:async(t,l={})=>{l.credentials||(l.credentials="include");let r=await fetch(t,l).catch(e);return r&&r.ok?(await r.text().catch(e)).replace(/(\n|\r|\t)/g,""):""}}},{_TEXT:Ir}=br(),xr=async(e,t={},l="")=>{t.credentials||(t.credentials="include"),t.method||(t.method="POST"),t.mode||(t.mode="cors"),t.body||(t.body=l);let r=await fetch(e,t).catch(Dl);return r&&r.ok?await r.text().catch(Dl):""},Cr={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},Ar=async(e,...t)=>{let l=or(...t),r={headers:Cr,referrer:ir()};return xr(e,r,l).catch(Dl)},Lr=async(e,t="")=>{let l=await Ir((e=>lr()+"delete/?id="+Ft+"&no="+e)(e));if(!l)return Yo("not available");let r={[bt]:"",_GALLTYPE_:Ht};if(!kr(l,"delete",r))return Yo("no form");let n=cr(l);if(!n)return Yo("no secret");r.service_code=sr(r.service_code,n);let i=l.match(/formData \+= "&([0-9a-z]+)=([0-9a-z]+)&/);if(!i)return Yo("not valid");if(r[i[1]]=i[2],t&&(r.password=t),i=l.match(/dcc_key_v1 = document.getElementById\(["']([^"']+)["']\).getAttribute\(["']([^"']+)["']/),i){let e=l.match(new RegExp(`<input[^>]+id=["']${i[1]}["'][^>]*>`));e&&(r.dcc_key_v1=mr(e[0],i[2]))}return await Ml(Ar,[t?Bt:$t],r,"delete_submit")},Dr=async(e,t,...l)=>{let r=or(...l),n={headers:Cr,referrer:ar(e)};return xr(t,n,r).catch(Dl)},Er=async(e,{num:t,id:l,value:r,vCurT:n},i="")=>{let a={ci_t:Sl("ci_c"),id:Ft,re_no:e,mode:"del",[bt]:"",_GALLTYPE_:Ht};return i&&(a[l]=r,a.no=t,a.re_password=i,a.v_cur_t=n),await Ml(Dr,[e,"/board/comment/comment_delete_submit"],a,"comment_delete_submit")},Tr=async e=>{let t={r_key:Vt,gall_id:Ft,gall_no:Wt,post_no:"",upload_ing:"N",_GALLTYPE_:Ht};try{let l=((e,t)=>{let l=Pl("form",null,{entype:"multipart/formdata"}),r=new FormData(l);for(let t in e)r.append(t,e[t]);return t&&t.name&&r.append("files[]",t,t.name),r})(t,e),r={credentials:"same-origin",referrer:jt,referrerPolicy:"strict-origin-when-cross-origin"},n=Kt+"upimg.dcinside.com/upimg_file.php?id="+Ft+"&r_key="+Vt,i=await xr(n,r,l).catch(Dl);return i?JSON.parse(i).files[0]??null:null}catch(e){return Dl(e),null}},qr=e=>{let t=or({id:Ft,r_key:Vt,temp_no:e}),l={headers:Cr,credentials:"same-origin",referrer:jt+"/upload/image?xssDomain=dcinside.com",referrerPolicy:"strict-origin-when-cross-origin"},r=rr()+"temp/upimg_pop_del";xr(r,l,t).catch(Dl).then((e=>"true"!=e&&Cn(me)))},Jr={},Kr=[],jr=!1,Gr=[],zr=async()=>{if(!Gr.length)return jr=!1;let e=Gr.shift(),t=e[0],l=e[1];if(null!=Jr[t])return l(Jr[t]),Xt(zr,1);let r=await(async e=>{let t=jt+"dccon/package_detail",l={headers:Cr},r=or({ci_t:Sl("ci_c"),package_idx:"",code:e}),n=await xr(t,l,r).catch(Dl);if(!n)return null;try{return JSON.parse(n)}catch(e){return Dl(e),null}})(t).catch(Dl);if(!r)return l();let n=r.info.title,i=r.info.package_idx,a=[];for(let e of r.detail)a.push({title:e.title,buy:!1,package_idx:i,package_title:n,code:e.path});let o={title:n,idx:i,buy:!1,code:r.info.list_img_path,detail:a};Sr(o),l(Jr[t]),Xt(zr,1)},Yr=e=>{let{r:t,p:l}=El();return Gr.push([e,t]),jr||(jr=!0,zr()),l},Sr=e=>{let t=cn("dccon-pk")??{};if(null!=t[e.idx]){let l=t[e.idx];if(l.buy||!e.buy)return;l.detail=e.detail,l.buy=!0}else t[e.idx]=e;on("dccon-pk",t)},Ur=(e,t)=>{let l=(e=>{let t=cn("dccon-pk");if(!t)return null;for(let l in t)if(t[l].title==e)return t[l];return null})(e);if(!l||!l.detail)return null;for(let e of l.detail)if(e.title==t)return e;return null},$r=(e,t)=>{let l=Ur(e,t);return l?Br(l.code):null},Br=e=>Kt+"dcimg5.dcinside.com/dccon.php?no="+e,Zr=async(e,t)=>{let l,r=await Ar(jt+"dccon/lists",{ci_t:Sl("ci_c"),target:e,page:t}).catch(Dl);if(!r)return 0;if("not_login"==r)return 0;if("{"!=r.substring(0,1))return 0;try{l=JSON.parse(r)}catch(e){return Dl(e),{}}let n=l.list,i=1;if("recent"==e){let e=[];for(let t of n){let l=t.list_img.match(Dt);l&&e.push({package_title:u,package_idx:t.package_idx,idx:t.idx,code:l[1],title:t.title})}xa({title:u,idx:-1,detail:e})}else if("icon"==e){i=l.max_page;for(let e of n){let t=e.title,l=e.package_idx,r=e.main_img_url.match(Dt);if(!r)continue;let n=[];for(let r of e.detail){let e=r.list_img.match(Dt);e&&n.push({package_title:t,package_idx:l,idx:r.detail_idx,buy:!0,code:e[1],title:r.title})}let i={title:t,idx:l,buy:!0,code:r[1],detail:n};xa(i),Sr(i)}}return i},Mr=async e=>{if(!e.buy)return Cn(Ue);let t=e.package_idx,l=e.idx,r={id:Ft,no:void 0,package_idx:t,detail_idx:l,ci_t:Sl("ci_c"),input_type:"write",t_vch2:void 0,t_vch2_chk:void 0,c_gall_id:Ft,c_gall_no:void 0,[bt]:"",check_6:void 0,check_7:void 0,check_8:void 0,_GALLTYPE_:Ht};await Ml(Ar,[Ut],r,"insert_icon"),Ca("recent").catch(Dl)},Xr=async(e,t)=>{if(!e.buy)return Cn(Ue);let l=e.package_idx,r=e.idx,n=ia();if(!n.length)return Cn(d);let a=Io[t],o={id:Ft,no:t,package_idx:l,detail_idx:r,name:n,ci_t:Sl("ci_c"),input_type:"comment",t_vch2:a.t_vch2,t_vch2_chk:a.t_vch2_chk,c_gall_id:Ft,c_gall_no:t,[bt]:"",check_6:a.check_6,check_7:a.check_7,check_8:a.check_8,_GALLTYPE_:Ht},c={};if(!nl){let e=aa();if(e.length<2)return Cn(h);c.password=e}if(Ll()){let e=oa();if(!e.length)return Cn(f);c.code=e}fl&&(c.c_no=fl);let s=await Ar(Ut,o,c);"ok"==s?($i[t](-1,!0),i(0)):DEBUG&&Dl("insert dccon comment fail",s),Xt(ra,500),Ca("recent")},Nr=(e,t,l)=>{let r=`<img class="dccon" src="${l}">`;e.innerHTML=e.innerHTML.r(t,r)},Qr=0,Pr=e=>{let t=(e=e.r(/onmousedown="[^"]+"/g,"").r(/class="written_dccon[^"]*"/g,'class="d"')).matchAll(/onerror="[^"]+"/g);for(let l of t){Qr++;let t="error-"+Qr;e=e.r(l[0],`id="${t}" onerror="window.postMessage(JSON.stringify({type:'${_t}',id:'${t}' }),'*')"`)}return e},Rr=(e,t)=>{let l=e.match(t);if(l){DEBUG&&Dl("replacing",e);for(let t of l)e=e.r(At(t),(r=Nt(t.split('"')[1]),`onclick="window.postMessage(JSON.stringify({type:'${mt}',url:'${r}' }),'*')"`));DEBUG&&Dl("replaced",e)}var r;return e},Fr=e=>(e=Rr(e,Tt),e=Rr(e,Jt)),Hr=e=>"https://image.dcinside.com/viewimage.php?id=&no="+e,Vr=e=>{ml=st[e],Cl&&Cl.postMessage({type:"iv",iv:ml})},Wr=(e,t)=>{for(let l in t){let r=vr(e,l);r&&(t[l]=r)}!Ht&&jo._GALLTYPE_&&(Ht=jo._GALLTYPE_),!Wt&&jo.gallery_no&&(Wt=jo.gallery_no),jo.r_key&&(Vt=jo.r_key)},en=(e,t)=>{let l=e.matchAll(/<input[^>]+name=["']([^"']+)["'][^>]+value=["']([^"']*)["']/g);if(l)for(let e of l)t[e[1]]=e[2]};DEBUG&&Dl("initializing");let tn=e=>(alert(e),0);if(!(e=>{let t=e.match(/^https?:\/\/(gall|m).dcinside.com\/([^\n]+)$/);if(!t)return tn(g);let l=null;return"gall"==t[1]?(l=t[2].match(/id=([A-Za-z0-9_]+)($|\&|#)/),ll=/^mgallery/.test(t[2]),rl=/^mini/.test(t[2])):(tl=!0,l=t[2].match(/(board|mini)\/([A-Za-z0-9_]+)($|\?|\/|#)/),ll=tt[ut]("micon").length>0,rl=tt[ut]("mnicon").length>0),l&&l.length?(Ft=tl?l[2]:l[1],1):tn(m)})(location.href))return;if(tt.cookie="m_dcinside_web=done; path=/; domain=.dcinside.com",Pl("meta",rt,{name:"viewport",content:"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0"}),tl)return tn(_),location.href=nr();if(tt[gt])return tt[gt]();tt[gt]=()=>Cn(ve),tt.title="  :: "+tt.title;let ln={},rn={},nn=e=>{let t=JSON.stringify(e??ln);nt?.setItem(gt,t)},an=(e,t)=>{ln[e]=t,rn[e]?.(t)},on=(e,t)=>{an(e,t),nn()},cn=e=>ln[e]??null,sn=()=>{let e=nt?.getItem("block_all");return e?JSON.parse(e):{on:1,word:"",id:"",nick:"",ip:""}},un=()=>{let e=nt?.getItem("block_parts");return e?JSON.parse(e):{}},pn=(e,t)=>un()[e]??{on:1,word:"",id:"",nick:"",ip:"",name:t},dn=(e,t)=>!!t.on&&(hn(e,"title",t,"word",!0)||hn(e,"nickname",t,"nick")||hn(e,"id",t,"id")||hn(e,"ip",t,"ip")),hn=(e,t,l,r,n=!1)=>{if(!l[r])return!1;let i=Yl(l[r]);for(let l of i)if(n){if(e[t].includes(l))return!0}else if(e[t]==l)return!0;return!1},fn=e=>{e.on=1,(e=>{nt?.setItem("block_all",JSON.stringify(e))})(e);for(let t of Yi)dn(t,e)?Hl(t.chat,"block"):Vl(t.chat,"block")},gn=(e,t)=>{e.on=1;let l=un();l[t]=e,(e=>{nt?.setItem("block_parts",JSON.stringify(e))})(l);for(let t of Yi)dn(t,e)?Hl(t.chat,"block"):Vl(t.chat,"block")},mn=(e,t,l)=>{let r=Yl(e[t]).filter((e=>""!=e));r.includes(l)||r.push(l),e[t]=r.join("||")},_n=(e,t,l)=>{let r=Yl(e[t]).filter((e=>""!=e));for(let e=0;e<r.length;e++){if(r[e]==l){r.splice(e,1);break}}e[t]=r.join("||")};(async()=>{let e=await Ir(nr()).catch(Dl),t=pr(e,vt,"login_box");if(DEBUG&&Dl("login",t),t){let e=pr(t,"button","btn_inout");if(DEBUG&&Dl("string",e),e&&e==y){nl=!0;let e=fr(t,"strong","nickname");e&&(ol=e);let l=dr(t,"strong","writer_nikcon");if(l){let e=mr(l,"onClick").match(/\/([a-zA-Z0-9_-]+)['"]/);e&&(cl=e[1]),e=l.match(/src=["']([^"']+)["']/),e&&(sl=e[1],ul=_r(e[1]))}}}DEBUG&&Dl("login",nl),l?.(),el=vr(e,"gallery_name"),co[dt]=He+" - "+el})(),Fl(lt),Hl(lt,wt);for(var yn=1;yn<99999;yn++)window.clearInterval(yn);for(yn=1;yn<99999;yn++)window.clearTimeout(yn);let wn=STYLESHEET.r(/_w/g,"width").r(/_h/g,"height").r(/_b/g,"background").r(/_m/g,"margin").r(/_p/g,"padding").r(/_d/g,"display").r(/_i/g,"!important").r(/_P/g,"position").r(/_T/g,"top").r(/_B/g,"bottom").r(/_L/g,"left").r(/_R/g,"right").r(/_r/g,"relative").r(/_a/g,"absolute").r(/_o/g,"overflow").r(/_f/g,"flex").r(/_F/g,"font").r(/_j/g,"justify-content").r(/_g/g,"grid-").r(/_c/g,"calc").r(/_x/g,"100%");wn=ct?wn.r(/_s/g,""):wn.r(/_s/g," or (max-width:700px)"),Pl("style",rt,{[dt]:wn}),Pl("link",rt,{rel:"stylesheet",href:Kt+"fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"}),ot&&Bl(),DEBUG&&Dl("ui"),s=Pl(vt,lt,"log",wt),Wl();let On=Pl(vt,lt,"o");Pl(vt,On,{[dt]:be},"drop");let vn=Pl(vt,lt,"o"),kn=(e=!1)=>{DEBUG&&Dl("render overlay",e&&1==vn.childNodes.length,vn.childNodes.length),e&&1==vn.childNodes.length||!vn.lastChild?Vl(vn,"wait"):Hl(vn,"wait"),er=0!==vn.childNodes.length},bn=!0;tt.addEventListener("keyup",(e=>{"Enter"==e.key&&(bn=!0)})),tt.addEventListener("keypress",(e=>{bn&&"Enter"===e.key&&er&&(vn.lastChild&&vn.lastChild.enter?.(),bn=!1)}));let In,xn=({title:e,desc:t,options:l,close:r,html:n,input:i,nowrap:a})=>{l||(l=[{text:w,[ft]:e=>e()}]);let o=Pl(vt,vn,"modal");e&&Pl(vt,o,{[dt]:e},"tt");let c=Pl(vt,o,"desc");o.content=c,t&&(n?c.innerHTML=t:c[dt]=t);let s=()=>{Hl(o,wt),o.remove(),kn()};r&&Rl(Pl("a",o,{[ft]:s},"b.close.abs-tr"),"close"),void 0!==i&&(o.input=a?Pl("input",o,{type:"password",value:i},"nowrap"):Pl("textarea",o,{value:i}));let u=Pl(vt,o,"opts.fr");1===l.length&&(l[0].enter=!0);for(let e of l){let t=()=>{r[dt]="",Rl(r,"progress_activity","progress")},l=null!=e.icon,r=Pl("a",u,{[dt]:l?"":e.text??e,[ft]:e.onclick?()=>e.onclick(s,t):s},"sb.r");l&&(Rl(r,e.icon),Pl(kt,r,{[dt]:e.text})),e.enter&&Xt((()=>{o.enter=()=>r.click(),a&&tr(o.input,r,!1,!0)}),100)}return kn(),o},Cn=e=>xn({desc:e}),An=(e,{text:t,top:l=!1},...r)=>{Hl(e,"has-tooltip");let n=Pl(vt,e,"tooltip",l?"tp":"bt",...r);return Pl(kt,n,{innerText:t}),n},Ln=(e,t=[])=>{e.oncontextmenu=e=>{e.preventDefault();let l=e.clientX,r=e.clientY;for(option of(In&&In.remove(),In=Pl(vt,lt,"p.ctx"),In.style.left=l+"px",In.style.top=r+"px",t)){if(option.hr){Pl("hr",In);continue}let e=Pl("a",In,"fr.b");option.icon&&Rl(e,option.icon),option.text&&Pl(kt,e,{[dt]:option.text}),option[ft]&&(e[ft]=option[ft])}return In}};tt.addEventListener("click",(()=>{In&&In.remove(),In=null}));let Dn=Pl("main",lt);DEBUG&&Dl("video");let En,Tn=Pl(vt,Dn,"video"),qn=Pl(vt,Tn,"menu"),Jn=Pl(vt,Tn,"main"),Kn=!0,jn=e=>{Kn="boolean"==typeof e?e:!Kn,Kn?(Vl(qn,"e"),En[dt]="expand_less"):(zn&&Yn.click(),Hl(qn,"e"),En[dt]="expand_more")};Pl(vt,qn,{[ft]:jn},"stretch");let Gn=Pl("a",qn,{[ft]:()=>{Hl(Jn,"go"),Vl(Bn,wt)}},"b");Rl(Gn,"add"),Pl(kt,Gn,{[dt]:Le});let zn=!1,Yn=Pl("a",qn,"b",Ot),Sn=Rl(Yn,"pan_tool"),Un=Pl(kt,Yn,{[dt]:De});Yn.onclick=()=>{zn=!zn,zn?(Hl(Yn,".t"),Sn[dt]="check",Un[dt]=Ee,Hl(Jn,"rlc")):(Vl(Yn,".t"),Sn[dt]="pan_tool",Un[dt]=De,Vl(Jn,"rlc"))};let $n=Pl("a",qn,"b",Ot);Rl($n,"close"),Pl(kt,$n,{[dt]:qe}),En=Rl(Pl("a",qn,{[ft]:jn},"b.fix-tl"),"expand_less");let Bn=Pl(vt,Jn,"p.fr.blank"),Zn=Pl("a",Bn,{[ft]:()=>{Vl(Jn,"go"),Hl(Bn,wt)}},"b.abs-tr",wt);Rl(Zn,"close"),Rl(Bn,"link","ph").onclick=()=>Xn.focus();let Mn=()=>{""!==Xn.value?Vl(Bn,"blank"):Hl(Bn,"blank")},Xn=Pl("textarea",Bn,{[ht]:x,oninput:Mn,onchange:Mn},"src"),Nn=Pl("a",Bn,{[ft]:()=>Hn(Xn.value)},"sb");Pl(kt,Nn,{[dt]:w}),tr(Xn,Nn);let Qn=[],Pn=[],Rn=()=>{if(al)Vl(qn,wt);else{let e=Math.min(Pn.length,1);Hl(qn,wt),Qn.length=e;for(let e=1;e<Pn.length;e++)Pn[e]?.remove();Pn.length=e,zn&&Yn.click()}if(Hl(Yn,Ot),Vl(Yn,".t"),Vl(Jn,"go"),!Pn.length)return zn&&Yn.click(),Hl($n,Ot),Hl(Zn,wt),void Vl(Bn,wt);Vl($n,Ot),Vl(Yn,Ot),Vl(Zn,wt),Hl(Bn,wt),1==Pn.length?$l("--r2t","0px"):$l("--r2t","50%");let e=(Pn.length-1)/2,t=0,l=0;for(let r=0;r<Pn.length;r++){let n=Pn[r];Vl(n,..."r1.r2.c1.c2.c3.c4".split(".")),r<e?(Hl(n,"r1"),t++,Hl(n,"c"+t)):(Hl(n,"r2"),l++,Hl(n,"c"+l))}$l("--rw1",t),$l("--rw2",l)},Fn=e=>{let t=e.match(Et);if(t)return Vn(t[2]);let l=e.match(qt);if(l){let t=0,r=e.match(/t=([0-9]+)/);return r&&(t=r[1]),Wn(l[2],t)}ii(e)},Hn=e=>{if(DEBUG&&Dl("step 1",e),!e)return Cn(k);if("show log"==e)return Vl(s,wt);if("clear options"==e)return nn({});if("show options"==e)return Dl(ln);if("refresh update"==e)return Ko();let t=Qn.length;if(!/[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(e))return Cn(k);/^[A-Za-z]+:\/\//.test(e)||(e="https://"+e),DEBUG&&Dl("step 2",e),Fn(e),0===t&&1===Qn.length&&jn(!1),Rn()};onmessage=e=>{let t;t="object"==typeof e.data?e.data:JSON.parse(e.data),t&&(t.type==_t?(e=>{let t=tt[pt]("#"+e).parentNode,l=t.classList.contains("d"),r=t.getAttribute("data-src"),n=Pl("img",null,{src:r,draggable:!1},l?"d":"_");l||(n[ft]=()=>onImageClick(r)),t.insertAdjacentElement("beforebegin",n),Hl(t,wt)})(t.id):t.type==mt?(e=>{let t=decodeURIComponent(e).r(/&amp;/g,"&");xn({title:b,desc:t,options:[{text:I,icon:"open_in_new",[ft]:e=>{let l=Pl("a",null,{href:t,target:"_blank"});l.click(),l.remove(),e()}},{text:w,[ft]:e=>{Hn(t),e()},enter:!0}],close:!0})})(t.url):t.type==yt&&((e,t)=>{let l=document[pt]("#"+t);if(!l)return;let r,n=l[ut]("img"),i=[],a=0;for(let t=0;t<n.length;t++){let l=n[t];if(l.classList.contains(wt))continue;if(l.classList.contains("d"))continue;let r=l.getAttribute("data-osrc");r==e&&(a=t),i.push(r)}DEBUG&&Dl(i,e,a);let o=!1,c=Pl(vt,vn,{[ft]:()=>{o||(Hl(r,"fo"),Xt((()=>{c.remove()}),200),kn(!0))}},"ipvs");r=Pl("img",c,{src:i[a],draggable:!1,[ft]:()=>{o=!0,Mt((()=>o=!1))}},"ipv");let s=Pl(vt,c,"fr"),u=Pl("a",s,{[ft]:()=>{o=!0;let e=Pl("a",null,{href:r.src,download:""});e.click(),e.remove(),Mt((()=>o=!1))}},"b");Rl(u,"download"),Pl(kt,u,{innerText:Je}),kn()})(t.src,t.id))};let Vn=e=>{ii(Kt+"player.twitch.tv/?channel="+e+"&parent=gall.dcinside.com")},Wn=(e,t=0)=>{ii(Kt+"www.youtube.com/embed/"+e+"?start="+t,{allow:"autoplay; picture-in-picture"})},ei=null,ti="",li=!1,ri=0,ni=0,ii=(e,t={})=>{if(Xn.value="",Qn.includes(e)){let t=Pn[Qn.indexOf(e)];return Hl(t,"hl-alt"),void Xt((()=>Vl(t,"hl-alt")),500)}let l;al||(Qn.length=0,Pn[0]?.remove(),Pn.length=0),Qn.push(e),on("videos-"+Ft,Qn);let r=Pl(vt,Jn);Pn.push(r),l=()=>Pn.indexOf(r);let n=(t,l)=>{ei||(Hl(r,"drg"),ri=()=>r.getClientRects()[0].width/2,ni=()=>r.getClientRects()[0].height/2+50,$l("--mx",t-ri()+"px"),$l("--my",l-ni()+"px"),ei=r,ti=e)},i=(e,t)=>{Mt((()=>{$l("--mx",e-ri()+"px"),$l("--my",t-ni()+"px")}))},a=Pl(vt,r,{onmousedown:e=>{n(e.clientX,e.clientY),onmouseup=()=>{Vl(r,"drg"),ei=null,onmouseup=null,onmousemove=null},onmousemove=e=>i(e.clientX,e.clientY)},onmousemove:()=>{if(!ei||li)return;let e=l(),t=Pn.indexOf(ei);e!=t&&(Pn.splice(t,1),Pn.splice(e,0,ei),Qn.splice(t,1),Qn.splice(e,0,ti),li=!0,nn(),Xt((()=>li=!1),200),Rn())},ontouchstart:e=>{n(e.touches[0].clientX,e.touches[0].clientY);let t=()=>{Vl(r,"drg"),ei=null,ontouchend=null,ontouchcancel=null,ontouchmove=null};ontouchend=t,ontouchcancel=t,ontouchmove=e=>{i(e.touches[0].clientX,e.touches[0].clientY);let t=tt.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY);t?.onmousemove?.()}}},"grab.fr");Rl(a,"drag_indicator"),t.sandbox="allow-same-origin allow-scripts";let o=Pl("iframe",r,t);Rn(),o.src=e;let c=Pl("a",r,{[ft]:()=>((e,t)=>{ql(Qn,e),ql(Pn,t),nn(),t.remove(),Rn()})(e,r)},"close.b.abs-tr");Rl(c,"close"),An(c,{text:Ke})};rn["videos-"+Ft]=e=>{for(let t of e)Qn.includes(t)||Fn(t)},$n[ft]=()=>{Qn.length=0;for(let e of Pn)e.remove();Pn.length=0,nn(),Rn()},DEBUG&&Dl("chat");let ai=[],oi=Pl(vt,Dn,"chat"),ci=Pl(vt,oi,"hd");Pl(kt,ci,{[dt]:D},"h");let si=!1,ui=Pl("a",ci,{[ft]:()=>{si||(si=!0,Ko("button"),Hl(pi,"rotate-ccw-half"),Xt((()=>{si=!1,Vl(pi,"rotate-ccw-half")}),800))}},"help.b.abs-tl"),pi=Rl(ui,"sync"),di=Pl("a",ci,{href:Gt,target:"_blank"},"help.b.abs-tr");Rl(di,"help");let hi=Pl(vt,oi,"vp"),fi=Pl(vt,hi,"page"),gi=Pl(vt,oi,"cb-c"),mi=Pl("a",gi,{[ft]:()=>{for(;ai.length;)ai.shift().click()}},"r.b.ca.right.sd");Rl(mi,"close");let _i=()=>{ai.length?Vl(mi,"sd"):Hl(mi,"sd")},yi={},wi={},Oi=[],vi=Pl("a",gi,{[ft]:()=>{if(!Oi.length)return;let e=Oi.shift();for(let t of e[1])yi[e[0]](t);let t=Pl("a",null,{href:"#"+e[0]});t.click(),t.remove(),bi()}},"r.b.nt.right.sd");Rl(vi,"notifications");let ki=Pl(kt,vi,"cnt.abs-tl.fade"),bi=()=>{Oi.length?(Vl(vi,"sd"),Vl(ki,"fade"),ki[dt]=Oi.length<10?Oi.length:"9+"):(Hl(vi,"sd"),Hl(ki,"fade"))},Ii=(e,t)=>"n"+e+"_"+t,xi=(e,t,l=null)=>{if(!wi[e])return void(DEBUG&&Dl("post",e,"is not my post"));let r=Ii(e,t);if(!yi[r])return void(DEBUG&&Dl("comment",t,"is not a comment in interest"));let n=Oi.find((e=>e[0]==r));n||(n=[r,[]],Oi.push(n)),n[1].push(l),bi()},Ci=(e,t,l)=>{wi[e]=!0,yi[Ii(e,t)]=l},Ai=Pl("a",gi,{[ft]:()=>o(),onscroll:e=>e.preventDefault()},"r.pd.fr",ot?"m":"_",wt),Li=Pl(vt,Ai,"not-hover");Rl(Li,ot?Ct:"pause"),Pl(kt,Li,{[dt]:E},"text",ot?wt:"_");let Di=Pl(vt,Ai,"hover");Rl(Di,Ct);let Ei=Pl(kt,Di,{[dt]:T},"text",ot?wt:"_"),Ti=0;hi.onscroll=()=>{let e=Math.abs(fi.scrollHeight-hi.clientHeight-hi.scrollTop),t=Ti-e;if(Ti=e,e<2&&Gi(),0!=t)return t<0&&wl&&e>2?0==kl?o():void(kl=Math.max(kl-1,0)):void(!wl&&e<2&&o())};let qi={},Ji=async(e,t,l,...r)=>{let n,i=((e,t,l)=>l?e+l:e+t)(e,t,l);null!=qi[i]?n=qi[i]:(n=await Kl(i).catch(Dl),qi[i]=n),n=function(e){let t=Zt(e.substring(1,7),16);return"hsl("+Math.floor(360*t/16777215)+",80%,60%)"}(n);for(let e of r)e&&(e.style.color=n)},Ki=(e,t,l,r,n,i)=>{n&&Pl("img",e,{src:n},"nikcon");let a=Pl(kt,e,{[dt]:t},"name"),o=null;l?i||(o=Pl(kt,e,{[dt]:l},"ip.id")):r&&(o=Pl(kt,e,{[dt]:r},"ip")),Pl(kt,e,{[dt]:": "}),Ji(t,l,r,a,o)},ji=e=>{yl=e;let t=q;0!=e&&(t=e>20?J:e+K),Ei.innerText=j+t},Gi=()=>{let e=fi.childNodes;for(;e.length>80;){let t=e[0];zi(t)}},zi=e=>{for(let t=0;t<Yi.length;t++){if(Yi[t].chat==e){Yi.splice(t,1);break}}let t=e[ut]("removed");t&&t.length&&(t[0].value=!0),e.remove(),a(!0)};a=(e=!1)=>{if(kl=e?1:0,wl)return hi.scrollTop=fi.scrollHeight},o=()=>{wl=!wl,wl?(Hl(Ai,wt),ji(0),a(!0)):Vl(Ai,wt)};let Yi=[],Si={},Ui={},$i={},Bi={},Zi=e=>{wl||ji(yl+1),Vl(e,wt),a(!0)},Mi=async e=>{let t=e.num,l=Pl(vt,fi,"chl",wt),r=Pl("input",l,{type:wt,value:!1},"removed"),n=Pl(vt,l,"tt.r"),c=Pl(kt,n),s=e.nickname,u=e.ip,p=(e=>{let t=e.matchAll(/&#x([0-9a-fA-F]+);/g);for(let l of t){let t=String.fromCodePoint("0x"+l[1]);e=e.replace(l[0],t)}return e})(decodeURIComponent(e.title)),d=e.id,f=e.img,g=e.fix,m=e.my??!1,_=sn(),y=pn(Ft,el);(dn(e,_)||dn(e,y))&&Hl(l,"block"),Yi.push({chat:l,title:p,id:d,ip:u,nickname:s}),s?Ki(c,s,d,u,f,g):Hl(l,"notify");let v,k=Pl(kt,c,{[dt]:p},"tt"),b=!1,x=[];for(let t of p.matchAll(Lt)){let l=t[0],r=t[1],n=t[2],i=$r(r,n);i?(Nr(k,l,i),a(!0)):(x.push([l,r,n]),b||(b=!0,(async()=>{let{write:t}=await xo(e.num).catch(Dl);if(!t)return;let l=hr(t,"img","written_dccon");for(let e of l){let t=mr(e,"src").match(Dt);if(t)await Yr(t[1]).catch(Dl);else{let t=mr(e,"data-src").match(Dt);t&&await Yr(t[1]).catch(Dl)}}for(let e of x){let t=$r(e[1],e[2]);t&&Nr(k,At(e[0]),t)}a(!0)})()))}if(t){n.id=Ii(t,0);let e=Pl(vt,l,"w.zero");v=Pl(vt,e,"vp.post");let s=Pl(vt,v,{id:"pc-"+t},"page.pc"),p=!0;m&&Ci(t,0,(()=>{p&&n.click()}));let d=()=>{Hl(l,"open"),Vl(e,"zero"),i(0),wl&&o(),J(),ql(ai,n),ai.push(n),ai.length>5&&ai.shift().click(),_i(),xo(t).catch(Dl).then((({text:e})=>{const t=e.matchAll(/<iframe[^>]*id="movieIcon([^"]*)"[^>]*>[^<]*<\/iframe>/g);t?(async()=>{for(const l of t){const t=jt+"board/movie/movie_view?no="+l[1],r=await Ir(t);if(!r)continue;const n=r.match(/<video[^>]*poster="([^"]*)"[^>]*>[^<]*<source[^>]*src="([^"]*)"[^>]*type="([^"]*)"[^>]*>/);if(!n)continue;const i=Pl(vt,null,"v-container"),a=Pl(vt,i,"video_wrap");Pl("source",Pl("video",Pl(vt,a,"video_inbox"),{controls:!0,playsinline:!0,controlslist:"nodownload",poster:n[1],"data-no":l[1]},"dc_mv"),{src:n[2],type:n[3]}),e=e.r(l[0],i.outerHTML),i.remove()}s.innerHTML=e})():s.innerHTML=e}))};n.onclick=()=>{if(p=!p,hl==t&&i(0),p){for(ql(ai,n),Hl(e,"zero"),Vl(l,"open");s.lastChild;)s.lastChild.remove();return a(),void _i()}d()};let f,g,_=Pl(vt,e,"cm",wt),y=Pl(vt,_,"vp"),k=Pl(vt,y,"page"),b=Pl("a",_,{[ft]:()=>f()},"ex.sm.r");Rl(b,"more_vert");let I=Pl("a",e,{[ft]:()=>{hl==t?i(0):i(t,l,x)}},"ic.r"),x=Pl(kt,I,{[dt]:$}),C=Pl("a",e,{[ft]:()=>n.click()},"ex.alt");Rl(C,"expand_less");let A={},L=[],D=[],E=Pl(vt,k,"w"),T=0,q=0,J=async()=>{if("false"!=r.value)return;let e=await Ao(t).catch(Dl);if(!e)return;e.count?Vl(_,wt):Hl(_,wt);let o=T;for(let r in e.comments){if(L.includes(r))continue;L.push(r),q>20&&(E=Pl(vt,k,"w",wt),o++,q=0);let a=e.comments[r],c=Pl(vt,null,"w"),s=Pl("a",null,"cml.r");s.id=Ii(t,r);let d=a.text,f=a.target,g=a.name;if(f){let t=e.comments[f];t&&(g=t.name),Hl(s,"re"),Rl(Pl(vt,s,"re-icon"),xt)}let _=d.length>8&&d.substring(d.length-8)==gl;if(_?(gl="",Ci(t,f||r,(e=>{p&&n.click(),Hl(e,"hl"),Xt((()=>Vl(e,"hl")),500)}))):xi(t,f,s),s.onclick=()=>i(t,l,x,s,f||a.num,a.name,g),null==A[f])A[a.num]=c,c.appendChild(s),E.appendChild(c),D.length==o&&D.push(E);else{A[f].insertAdjacentElement("beforeend",s)}let y=Pl(vt,s,"writer-dlc");Ki(y,a.name,a.id,a.ip,a.img,a.fix),Pl(vt,s,{innerHTML:d},"text"),q++;let v=[{text:$e,icon:"delete",[ft]:async()=>{let e="",{delId:l,delValue:n,vCurT:i}=await xo(t).catch(Dl);if(u||a.ip){let{r:t,p:l}=El(),r=xn({title:z,input:e,nowrap:!0,options:[{text:w,[ft]:l=>{if(e=r.input.value,e.length<2)return Cn(h);l(),t(!0)}},{text:O,[ft]:e=>{e(),t(!1)}}]});if(!await l)return}let o=await Er(r,{num:t,id:l,value:n,vCurT:i},e);o||Cn(pe);let c=o.split("||");return"true"==c[0]?(s.remove(),J()):1==c.length?Cn(o):void Cn(pe)}}];(m||u||_||a.ip||a.id==cl)&&Ln(s,v)}g(),a(!0)};f=()=>{T++;let e=D[T];e&&Vl(e,wt),g()},g=()=>{T+1==D.length?Hl(b,wt):Vl(b,wt)};let K=Pl(kt,c,"cm.fr",wt);Rl(K,xt,"f");let j=Pl(vt,K,"nc.gray-div"),G=Pl(kt,K,{[dt]:"+"}),Y=[],S=[],U=[];for(let e=0;e<3;e++){let t=Pl(vt,j,"num-"+e);S.push(Pl(kt,t,"old")),U.push(Pl(kt,t,"new")),Y.push(t)}let B=(e,t,l)=>{let r=3-t+e,n=U[r][dt];S[r][dt]=n,U[r][dt]=l,l!=n&&(Hl(Y[r],"changed"),Xt((()=>Vl(Y[r],"changed")),500))},Z=e=>(e+"").split("").reverse();$i[t]=(e=-1,l=!1)=>{if("false"!=r.value)return void delete $i[t];let n=()=>{-1==e&&(e=Ui[t]+1),Ui[t]=e;let l=Z(e);l.length>3?(l="999".split(""),Vl(G,wt)):Hl(G,wt);for(let e=0;e<l.length;e++)B(e,l.length,l[e]);e?(Vl(K,wt),a(!0)):Hl(K,wt),p&&!wi[t]||J().catch(Dl)};l?n():Xt(n,Tl(1,ml))}}if(e.date){let t=Pt()-e.date;(t>ml||!vl)&&Zi(l),Xt((()=>Zi(l)),ml-t)}else Zi(l);wl||Gi();let C=[];(m||u||nl&&d==cl)&&C.push({text:$e,icon:"delete",[ft]:()=>{xn({title:Be,desc:Ze,options:[{text:w,enter:!0,[ft]:async(e,r)=>{r();let n="";if(u){let{r:t,p:l}=El(),r=xn({title:z,input:n,nowrap:!0,options:[{text:w,enter:!0,[ft]:(e,l)=>{if(n=r.input.value,n.length<2)return Cn(h);t(!0),e()}},{text:O,[ft]:e=>{t(!1),e()}}]});if(!await l)return e()}let i=await Lr(t,n);e();let a=i.split("||");if("false"==a[0])return Cn(a[1]);zi(l)}},{text:O}]})}},{hr:!0}),t&&(C.push({text:I,icon:"open_in_new",[ft]:()=>{let e=Pl("a",null,{href:ar(t),target:"_blank"});e.click(),e.remove()}},{text:Me,[ft]:()=>{window.navigator.clipboard.writeText(ar(t))}}),m||!u&&d==cl||(C.push({hr:!0}),u?C.push({text:Ne,[ft]:()=>{xn({title:Pe,desc:"IP: "+u,options:[{text:He,[ft]:e=>{let t=pn(Ft,el);t.on=1,mn(t,"ip",u),gn(t,Ft),e()}},{text:Fe,[ft]:e=>{let t=sn();t.on=1,mn(t,"ip",u),fn(t),e()}},{text:O}]})}}):C.push({text:Xe,[ft]:()=>{xn({title:Pe,desc:"ID: "+d,options:[{text:He,[ft]:e=>{let t=pn(Ft,el);t.on=1,mn(t,"id",d),gn(t,Ft),e()}},{text:Fe,[ft]:e=>{let t=sn();t.on=1,mn(t,"id",d),fn(t),e()}},{text:O}]})}}),C.push({text:Qe,[ft]:()=>{xn({title:Pe,desc:s,options:[{text:He,[ft]:e=>{let t=pn(Ft,el);t.on=1,mn(t,"nick",s),gn(t,Ft),e()}},{text:Fe,[ft]:e=>{let t=sn();t.on=1,mn(t,"nick",s),fn(t),e()}},{text:O}]})}}))),C.length&&(Ln(n,C),Ln(v,C))};DEBUG&&Dl("input login");let Xi=Pl(vt,oi,"li-c"),Ni=Pl("a",Xi,{[ft]:()=>c()},wt,"ex.tab"),Qi=Rl(Ni,"expand_more");c=()=>{bl=!bl,bl?(Qi.innerText="expand_more",Vl(Ri,wt)):(Qi.innerText="expand_less",Hl(Ri,wt)),a(!0)};let Pi,Ri=Pl(vt,Xi,"fr",wt),Fi=Pl("input",Ri,{type:"text",[ht]:G,maxlength:15,name:"name"}),Hi=Pl("input",Ri,{type:"password",[ht]:z,maxlength:20,name:"password"}),Vi=Pl(vt,Xi,"fr",wt),Wi=Pl("a",Vi),ea=Pl("img",Wi,{[ft]:()=>ra()},"captcha"),ta=Pl("input",Vi,{type:"text",[ht]:Y,maxlength:20}),la=()=>{rl&&(Il?(Fi.value=Il,Hl(Fi,Ot)):Vl(Fi,Ot))},ra=async()=>{if(ta.value="",Ll()){let e=Al(),t={ci_t:Sl("ci_c"),gall_id:Ft,kcaptcha_type:e?"write":"comment",_GALLTYPE_:Ht},l=jt+"kcaptcha/session";e?await Ar(l,t).catch(Dl):await Dr(hl,l,t).catch(Dl),ea.src=jt+"kcaptcha/image/?gall_id="+Ft+"&kcaptcha_type="+(e?"write":"comment")+"&time="+Pt()+"&_GALLTYPE_="+Ht,Vl(Vi,wt)}else Hl(Vi,wt)};l=()=>{nl||cn(V)?Hl(Xi,wt):(Vl(Ri,wt),Vl(Ni,wt),a(!0)),Pi?.()};let na=()=>Fi.value??"",ia=()=>Il||(nl?ol:na()),aa=()=>Hi.value??"",oa=()=>ta.value??"",ca=Pl(vt,oi,"ri-c",wt),sa=Pl(vt,ca,"tab"),ua=Pl(kt,sa,"name"),pa=Rl(sa,"more_horiz",wt),da=Pl(kt,sa,"name",wt),ha=Pl(kt,sa,{[dt]:S});DEBUG&&Dl("input chat");let fa=Pl(vt,oi,"ci-c"),ga=Pl(vt,fa,"f"),ma=Pl(vt,ga,"i"),_a="--ih",ya=Pl("textarea",ma,{[ht]:C,oninput:()=>{$l(_a,ya.clientHeight+12+"px"),ya.style.height=0,ya.style.height=ya.scrollHeight-19+"px",a(!0),Mt((()=>$l(_a,0)))},onblur:Wl},Ot),wa=null,Oa=null,va=null;i=(e,t,l,n=null,i=0,o="",c="")=>{if(null!=n&&n==va&&(e=0,i=0),wa&&Oa&&(va&&Vl(va,"rp"),Vl(wa,"wr"),Vl(wa,"rp"),Oa[dt]=$,Vl(Oa,"f-white"),Hl(ca,wt),Vl(hi,"r"),Hl(pa,wt),Hl(da,wt)),hl=e,fl=i,Al())il&&(Hl(ya,Ot),Hl(Xa,Ot),Hl(Da,Ot),Hl(bo,Ot),nl||Hl(Xi,wt)),Vl(fa,"wr"),ya[ht]=C,wa=null,Oa=null,va=null;else{if(il&&(Vl(ya,Ot),Vl(Xa,Ot),Vl(Da,Ot),Vl(bo,Ot),nl||Vl(Xi,wt)),Hl(fa,"wr"),Hl(t,"wr"),n&&i)Hl(n,"rp"),Hl(t,"rp"),ya[ht]=A,ua[dt]=o,o!=c&&(da[dt]=c,Vl(pa,wt),Vl(da,wt)),ha[dt]=S,l[dt]=O,Vl(l,"f-white");else{let t=Si[e];ua[dt]=t.name,ya[ht]=L,ha[dt]=U,l[dt]=B,Hl(l,"f-white")}Vl(ca,wt),Hl(hi,"r"),wa=t,Oa=l,va=n??null,ya.focus()}r(),ra(),Ya(),la(),a(!0)},DEBUG&&Dl("dccon");let ka=Pl(vt,fa,"p.p-dccon",wt),ba=Pl(vt,Pl(vt,Pl(vt,ka,"dcl"),"vp"),"page"),Ia=Pl(vt,Pl(vt,Pl(vt,ka,"dcc"),"vp"),"page"),xa=e=>{let t=e.idx,l=e.title,r="dc"+t,n=Pl(vt,null,"package"),i=tt[pt]("#"+r);if(i)Ia.replaceChild(n,i);else{Ia.appendChild(n);let t=Pl("a",ba,{href:"#"+r,[ft]:()=>{ya.focus(),Wl()}});l==u?Rl(t,"history"):Pl("img",t,{src:Br(e.code)})}n.setAttribute("id",r),Pl(kt,Pl(vt,n,"hd.r"),{[dt]:l});let a=Pl(vt,n,"flex.fr");for(let t of e.detail){let e=t.code,r=t.title,n=t.package_title;Pl("img",a,{loading:"lazy",src:Br(e),[ft]:async()=>{let t=await Yr(e);if(DEBUG&&Dl(n,r,t),Al()){Mr(t);let n=l;l==u&&(null!=Jr[e]||await Yr(e),n=Jr[e].package_title),ya.focus(),ya.value+=":"+n+", "+r+": "}else Xr(t,hl)}},"d")}},Ca=async e=>{await(async e=>{if("recent"==e&&await Zr(e,0),"icon"==e){let t=Math.min(await Zr(e,0),20);for(let l=1;t>=l;l++)await Zr(e,l)}})(e).catch(Dl)};rn["dccon-pk"]=e=>{for(let t in e){if(Kr.includes(t))continue;let l=e[t];for(let e of l.detail)Jr[e.code]=e;Kr.push(l.title)}};let Aa=!0,La=!1,Da=Pl("a",ga,{onmousedown:()=>(Aa=!Aa,Aa?(Vl(Ea,"f"),Hl(ka,wt)):(ya.focus(),Hl(Ea,"f"),Vl(ka,wt),La||(La=!0,Ca("recent"),Ca("icon"))),void Mt((()=>ya.focus())))},"d.b",Ot),Ea=Rl(Da,"mood");DEBUG&&Dl("upload");let Ta=Pl(vt,ga,"p.up.abs.vp.pv-vp",wt),qa=Pl(vt,Ta,"fr.page"),Ja=Pl("a",qa,{[ft]:()=>Ma.click()},"pv.r.b.o-l");Rl(Ja,"add_photo_alternate"),Pl(kt,Ja,{[dt]:Ge});let Ka=null,ja=!1,Ga=[],za=!1,Ya=()=>{null!==Ka&&(po?(Vl(Ka.preview,wt),ja?Vl(Ka.preview,"up"):Hl(Ka.preview,"up")):Hl(Ka.preview,wt)),Ra[dt]=Ga.length,0==Ga.length?Hl(Ra,wt):Vl(Ra,wt),za&&Al()?(Vl(Ta,wt),Hl(Pa,"f")):(Hl(Ta,wt),Vl(Pa,"f"))},Sa=(e=null)=>{za=null===e?!za:e,Ya()},Ua=(e,t)=>{let l=Pl(vt,e,"pv.r"),r=Pl(vt,l,"image"),n=Pl("img",r),i=Pl(vt,l,"desc"),a=Pl(kt,i,{[dt]:t.name},"file-name");return Pl(kt,i,{[dt]:"("+Ql(t.size)+")"},"size"),{p:l,c:r,i:n,n:a}},$a=e=>{let{p:t,c:l,i:r}=Ua(qa,e),n=Rl(l,"pending","pending.abs"),i=Rl(l,"warning","error.abs",wt),a=new FileReader;a.onload=()=>r.src=a.result,a.readAsDataURL(e);let{r:o,p:c}=El(),s={preview:t,img:r,original:e.name,name:"",size:e.size,type:e.type,upload:!1,file:e,error:!1,num:0,url:"",close:async()=>{t.remove();for(let e=0;e<Ga.length;e++){let t=Ga[e];if(s===t){Ga.splice(e,1);break}}Ya(),s.upload?qr(s.num):(await c.catch(Dl),s.error||qr(s.num))},p:c};Ga.push(s);let u=Pl("a",t,"close.abs-tr.b");Rl(u,"delete","f"),u.onclick=()=>s.close();let p=(e,...l)=>{Cn(e),Dl(e,...l),s.error=!0,Hl(t,"error"),Vl(i,wt)};return Tr(e).catch(Dl).then((e=>(Hl(n,wt),e?e.error?p(e.error,e):(s.upload=!0,Hl(t,"up"),s.name=e.name,s.url=e.url,s.num=e.file_temp_no,void o()):p(ge)))),s},Ba=(e=null)=>{if(null!==Ka&&Ka.close(),null===e)return Ka?.preview.remove(),on("zzal",""),Vl(uo,wt),void(Ka=null);Ka=e,Hl(Ka.preview,"o-f","z");for(let t=0;t<Ga.length;t++)Ga[t]===e&&Ga.splice(t,1);e.close=()=>{ja=!0};let{p:t,i:l,n:r}=Ua(to,e);Hl(t,"up","o-f"),Hl(uo,wt);let n=Pl("a",t,"close.abs-tr.b");Rl(n,"delete","f"),n.onclick=()=>{xn({desc:je,options:[{text:v,[ft]:e=>{Ba(null),t.remove(),e()},enter:!0},{text:O}]})};let i=()=>{l.src=e.img.src,r.innerText=e.name;let t=(e=>({name:e.name,size:e.size,type:e.type,url:e.url,src:e.img.src}))(e);on("zzal",JSON.stringify(t))};e.upload?i():(async()=>{await e.p,i()})(),Ya()},Za=e=>e.size>2e7?Cn(fe):il?Cn(xe):($a(e),Ya(),void Sa(!0)),Ma=Pl("input",null,{type:"file",accept:"image/*",multiple:"true",onchange:()=>{for(let e of Ma.files)Za(e)}}),Xa=Pl("a",ga,{[ft]:()=>Sa()},"up.b.abs-tl",Ot);An(Xa,{text:ke,top:!0}),ondragenter=async e=>{if(e.dataTransfer&&e.dataTransfer.files){let t=(e.dataTransfer.files.length>0?e.dataTransfer.files:e.dataTransfer.items)[0];if(!t.type||"image"!=t.type.split("/")[0])return;Hl(On,"drag")}},On.ondragenter=e=>{e.preventDefault()},On.ondragover=e=>e.preventDefault(),On.ondragleave=()=>{Mt((()=>Vl(On,"drag")))},On.ondrop=e=>{if(e.preventDefault(),Vl(On,"drag"),e.dataTransfer.files){let t=!1;for(let l of e.dataTransfer.files)l.type&&"image"==l.type.split("/")[0]?Za(l):t=!0;t&&Cn(Ie)}},at&&tt.addEventListener("paste",(async()=>{let e=await window.navigator.clipboard.read(),t=0;for(let l of e){Dl(l);let e=null;for(let t of l.types)if(e=t.match(/image\/(.+)$/),Dl(e),e)break;if(Dl(e),!e)continue;let r=await l.getType(e[0]),n=new File([r],`image_${t}.${e[1]}`);Za(n),t+=1}}));let Na,Qa,Pa=Rl(Xa,"add_circle"),Ra=Pl("span",Xa,{[dt]:0},"cnt.abs-tr",wt);r=()=>{Al()&&!il?Vl(Xa,Ot):Hl(Xa,Ot)},DEBUG&&Dl("settings");let Fa=Pl(vt,fa,"p.p-settings",wt);Pl(kt,Pl(vt,Fa,"hd"),{[dt]:Z},"h"),Rl(Pl("a",Fa,{[ft]:()=>Na()},"b.abs-tr"),"close");let Ha=Pl("a",Fa,{[ft]:()=>Qa()},"b.abs-tl",wt);Rl(Ha,"navigate_before");let Va=Pl(vt,Fa),Wa=Pl(vt,Va,"opts"),eo=Pl(vt,Va,"opts",wt),to=Pl(vt,Va,"opts",wt),lo=Pl(vt,Va,"opts",wt),ro=Wa;Qa=(e=Wa)=>{Hl(ro,wt),Vl(e,wt),ro=e,e==Wa?Hl(Ha,wt):Vl(Ha,wt)};let no=(e,t,l,r,n=!1,i=Wa)=>{let a=n,o=Pl(vt,i,"opt");a&&Hl(o,"chk");let c=Pl(vt,o,"label.fr");t&&Rl(c,t),Pl(kt,c,{[dt]:e});return Rl(Pl(kt,o,"value"),"check_small"),o.onclick=()=>on(e,!a),rn[e]=e=>{a=e,a?(Hl(o,"chk"),l?.()):(Vl(o,"chk"),r?.())},an(e,n),o},io=(e,t,l,r,n,i,a)=>no(e,t,(()=>$l(l,r)),(()=>$l(l,n)),i,a),ao=(e,t,l="")=>{let r=Pl(vt,Wa,{[ft]:()=>Qa(t)},"opt.r"),n=Pl(vt,r,"label.fr");return l&&Rl(n,l),Pl(kt,n,{[dt]:e}),Rl(r,"navigate_next","abs-r"),r};ao(We,eo,"block");let oo=(e,t,l,r)=>{let n=Pl("a",t,{[ft]:()=>{let t=xn({title:e,options:[],close:!0}).content,n=Pl(vt,t,"b-entry.fr"),i=()=>{Fl(n);let e=l?sn():pn(Ft,el),t=e[r].split("||");for(let a of t){if(""==a)continue;let t=Pl(vt,n,"entry.fr");Pl(kt,t,{[dt]:'"'+a+'"'});let o=Pl("a",t,{[ft]:()=>{_n(e,r,a),l?fn(e):gn(e,Ft),i()}});Rl(o,"close","sml")}};i();let a=Pl(vt,t,"b-wrap.fr"),o=Pl("input",a,"nowrap"),c=Pl("a",a,{[ft]:()=>{if(!o.value)return;let e=l?sn():pn(Ft,el);mn(e,r,o.value),l?fn(e):gn(e,Ft),i(),o.value=""},[dt]:Ve},"sb");tr(o,c,!1,!0)}},"opt.r"),i=Pl(vt,n,"label.fr");Pl(kt,i,{[dt]:e}),Rl(n,"navigate_next","abs-r")};Pl(vt,eo,{[dt]:Fe},"opt.hr"),oo(Re,eo,!0,"word"),oo(Xe,eo,!0,"id"),oo(Ne,eo,!0,"ip"),oo(Qe,eo,!0,"nick");let co=Pl(vt,eo,{[dt]:He},"opt.hr");oo(Re,eo,!1,"word"),oo(Xe,eo,!1,"id"),oo(Ne,eo,!1,"ip"),oo(Qe,eo,!1,"nick"),ao(te,to);let so=Pl("input",null,{type:"file",accept:"image/*",multiple:"true",onchange:()=>{if(0===so.files.length)return;let e=$a(so.files[0]);Ba(e),po||ho.click()}}),uo=Pl("a",to,{[ft]:()=>so.click()},"pv.r.b.o-f");Rl(uo,"add_photo_alternate"),Pl(kt,uo,{[dt]:ze});let po=!1,ho=no(le,null,(()=>{po=!0,null!==Ka&&Vl(Ka.preview,wt)}),(()=>{po=!1,null!==Ka&&Hl(Ka.preview,wt)}),!1,to),fo="",go=Pl("a",to,{[ft]:()=>{let e=xn({title:re,input:fo,options:[{text:w,[ft]:t=>{fo=e.input.value,on("footer",fo),t()}},{text:O}]}),t=e.input;Hl(t,"ft");let l=Pl(kt,null,{[dt]:"-  ",[ft]:()=>t.focus()},"footer-static");t.insertAdjacentElement("afterend",l)}},"opt.r");Pl(kt,go,{[dt]:re},"label"),Rl(go,"navigate_next","abs-r"),no(W,"dark_mode",(()=>Vl(lt,"light")),(()=>Hl(lt,"light")),!0);let mo=no(M,"splitscreen",(()=>{al=!0,ot&&!cn("mado")?xn({title:w,desc:Te,options:[{text:v,[ft]:e=>{Rn(),on("mado",!0),e()},enter:!0},{text:O,[ft]:e=>{mo.click(),e()}}]}):Rn()}),(()=>{al=!1,Rn()}),!ot);ao(ee,lo);let _o=!0;no(R,null,(()=>_o=!0),(()=>_o=!1),!0),no(V,null,(()=>{Hl(Ri,wt),Hl(Ni,wt)}),(()=>{nl||(Vl(Ri,wt),Vl(Ni,wt))})),no(F,null,(()=>Vr(1)),(()=>Vr(0))),no(H,null,(()=>Hl(Dn,"co")),(()=>Vl(Dn,"co"))),no(ne,null,(()=>Vl(fi,"hn")),(()=>Hl(fi,"hn")),!1,lo),no(Q,null,(()=>{Vl(fi,"hu"),a(!0)}),(()=>{Hl(fi,"hu"),a(!0)}),!0,lo);io(Ae,null,"--cc","#fc5","var(--cf)",!0,lo);io(X,null,"--sb","smooth","auto",!0,lo);let yo="--fs";no(N,null,(()=>{$l(yo,"15px"),a(!0)}),(()=>{$l(yo,"13px"),a(!0)}),!1,lo);io(P,null,"--ds","60px","80px",!1,lo),Pl(kt,Fa,{[dt]:"version: "+VERSION},"version");let wo=!0;Na=()=>{wo=!wo,wo?(Vl(ko,"f"),Hl(Fa,wt)):(Hl(ko,"f"),Vl(Fa,wt))};let Oo=Pl(vt,fa,"fr.sc"),vo=Pl("a",Oo,{[ft]:Na},"b.gray"),ko=Rl(vo,"settings"),bo=Pl("a",Oo,"sb",Ot);Pl(kt,bo,{[dt]:ie}),tr(ya,bo,!0),DEBUG&&Dl("funcs");let Io={},xo=async(e,t=!1)=>{if(!t&&null!=Si[e])return Si[e];let l={num:e,name:"",text:ae,write:"",esno:"",string:"",delId:"",delValue:"",vCurT:""},r=await Ir(ar(e)).catch(Dl),n=()=>l;dl=!!new RegExp(`id="code_${e}"`).test(r);let i=pr(r,vt,"write_div");if(!i)return n();let a=pr(r,vt,"gallview_head");if(!a)return n();let o=dr(a,vt,"gall_writer");if(!o)return n();l.name=mr(o,"data-nick"),l.write=i,l.text=((e,t)=>{let l=e.matchAll(/<(img|video)[^>]*src="[^">]+no=([0-9a-zA-Z]+)[^">]*"[^>]*>/g);for(let r of l){let l=r[0],n=l,i=r[2];if(DEBUG&&Dl("src",i),/class="d"/.test(l))continue;let a=l.match(/class="([^"]+)"/);n=a?n.r(a[0],`class="${a[1]} img"`):n.r(">","")+' class="img">';let o=l.match(/on[Cc]lick="[^"]+no=([0-9a-zA-Z]+)[^"]*"/);n=o?n.r(o[0],`onclick="window.postMessage(JSON.stringify({type:'${yt}',src:'${Hr(o[1])}',id:'${t}'}))" data-osrc="${Hr(o[1])}"`):n.r(">","")+` onclick="window.postMessage(JSON.stringify({type:'${yt}',src:'${Hr(i)}',id:'${t}'}))" data-osrc="${Hr(i)}" draggable="false">`,e=e.r(l,n)}return e})(Fr(Pr(i).r(/(\r|\t)/g,"").r(/[ ]{2,}/g," ")),"pc-"+e);let c=vr(r,"e_s_n_o");c&&(l.esno=c),l.string=cr(r),Si[e]=l;let s={};if(kr(r,"_cmt_del_form_",s))for(let e in s)l.delId=e,l.delValue=s[e];let u=vr(r,"v_cur_t");u&&(l.vCurT=u);let p={cur_t:"",check_6:"",check_7:"",check_8:"",check_9:"",check_10:"",recommend:"0",user_ip:"",t_vch2:"",t_vch2_chk:"",service_code:""};return Wr(r,p),p.service_code=sr(p.service_code,l.string),Io[e]=p,n()},Co=async(e,t,l)=>{let r,n=await Dr(e,rr()+"comment/",t).catch(Dl);if(!n)return!1;try{r=JSON.parse(n)}catch(e){return Dl(e,n),!1}let i=r.total_cnt;l.count=i;let a=r.comments;if(!a||!a.length)return!1;for(let e of a){let t=Zt(e.no);if(0==t)continue;let r={num:t,id:"",ip:"",name:"",img:"",fix:!1,text:"",target:0};if(null!=l.comments[t])continue;l.comments[t]=r,r.id=e.user_id,r.ip=e.ip,r.name=e.name,r.text=Fr(Pr(e.memo).r(/\n/g,"<br />"));let n=e.c_no;n&&(r.target=Zt(n));let i=e.gallog_icon.match(/\<img src='([^']+)'/);if(i){let e=i[1];r.img=e,r.fix=_r(e)}}return!0},Ao=async e=>{let{esno:t}=await xo(e).catch(Dl),l=Ui[e],r={count:l,num:0,comments:{}};null!=Bi[e]&&(r=Bi[e]);let n={id:Ft,no:e,cmt_id:Ft,cmt_no:e,focus_cno:"",focus_pno:"",e_s_n_o:t,comment_page:1,sort:"D",prevCnt:"0",board_type:"",_GALLTYPE_:Ht},i=!0;for(;i;)i=await Co(e,n,r).catch(Dl),n.comment_page++;return l!=r.count&&$i[e](r.count,!0),Bi[e]=r,r},Lo=[],Do=async(e,t=!1)=>{if(0==e.length)return;vl?Ol&&Mi({title:ue}):t=!0,e=e.sort(((e,t)=>e.num-t.num));let l=0;for(let r of e)Lo.includes(r.num)||(await Mi(r).catch(Dl),r.count&&$i[r.num]?.(r.count,t)),l=Math.max(l,r.num);_l=Math.max(_l,l),Cl&&Cl.postMessage({type:"ln",n:_l}),vl||(Mi({title:se}),vl=!0,il&&Mi({title:Oe})),Ol=!1},Eo=()=>{let e,t,l,r,n,i,a,o,c,s,u,p,d,h,f,g;try{e=_DEBUG,t=_URL,l=_TEXT,r={},n=(e,t)=>{r[e]=t,self.postMessage({type:"cc",n:e,c:t})},i=async e=>self.postMessage({type:"pd",d:e}),a=_IT,o=_IH,c=_OH,s=_AT,u=_A,p=_TF,d=_SS,h=_SN,f=Number.parseInt,g=()=>_LN}catch{e=Dl,t=nr(),l=Ir,r=Ui,n=(e,t)=>$i[e]?.(t,Ol),i=Do,a=fr,o=pr,c=dr,s=gr,u=mr,p=_r,d=ce,h=oe,f=Zt,g=()=>_l}let m=e=>e.replace(/&amp;/g,"&").replace(/&nbsp;/g," ").replace(/&#035;/g,"#").replace(/&#039;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');return{_UL:async()=>{let _=await l(t);if(_)try{_=_.replace(/(\n|\r|\t)/g,"");let e=[],t=_.matchAll(/<tr[^>]*class="[^"]*us-post[^"]*"[^>]*data-no="([^"]*)".+?<\/tr>/g);if(!t)return;for(let l of t){let t=l[0],i={num:0,subject:"",title:"",nickname:"",id:"",ip:"",date:0,img:"",fix:!1,count:0},_=f(l[1]);i.num=_;let y=t.match(/<span[^>]*class="[^"]*reply_num[^>]*"[^>]*>\[([0-9]+)\]<\/span>/),w=r[_]??0,O=0;if(y&&(O=f(y[1]),O&&(i.count=O)),_<=g()){O!=w&&n(_,O);continue}let v=a(t,"td","gall_tit");y&&(v=v.slice(0,v.length-y[1].length-2)),i.title=m(v);let k=o(t,"td","gall_num");if(k==d||k==h||"AD"==k)continue;let b=a(t,"td","gall_subject");if(i.subject=m(b),b==d||b==h||"AD"==b)continue;let I=c(t,"td","gall_writer");if(I){s(I,"data-nick",i,"nickname"),s(I,"data-uid",i,"id"),s(I,"data-ip",i,"ip");let e=I.match(/<img[^>]*src=["']([^"']+)["']/);if(e){let t=e[1];i.img=t,i.fix=p(t)}}let x=c(t,"td","gall_date"),C=u(x,"title");null!==C&&(i.date=Date.parse(C)),e.push(i)}await i(e)}catch(t){e(t)}}}},{_UL:To}=Eo(),qo=()=>{let e=async()=>{let t,l,r,n;try{t=_UL,l=_IV,r=()=>{},n=_DEBUG}catch{l=ml,t=To,r=e=>xl=e,n=Dl}await t().catch((e=>{n(e),postMessage({type:"err"})})),r(setTimeout(e,l))};return{_UC:e}},{_UC:Jo}=qo(),Ko=(...e)=>{if(Dl("init update",...e),Ol=!0,it){Cl&&Cl.terminate();let e=new Blob([`let _URL='${nr()}';`,`let _IV=${ml};`,`let _LN=${_l};`,`let _SS='${ce}';`,`let _SN='${oe}';`,`let{_IH,_OH,_IT,_AT,_A,_TF,_DEBUG}=(${ur.toString()})();`,`let{_TEXT}=(${br.toString()})();`,`let{_UL}=(${Eo.toString()})();`,`let{_UC}=(${qo.toString()})();`,"self.onmessage=async(e)=>{switch(e.data.type){case'iv':_IV=e.data.iv;break;case'ln':_LN=e.data.n;break;}};","_UC();"],{type:"text/javascript"}),t=URL.createObjectURL(e);Cl=new Worker(t),Cl.onerror=(...e)=>{Dl(...e),Ko("error",...e)},Cl.onmessage=async e=>{let t=e.data;if(t&&t.type){if("pd"==t.type)return await Do(t.d);if("cc"==t.type)return $i[t.n]?.(t.c,Ol);if("err"==t.type)return Ko("worker err")}}}else xl&&clearTimeout(xl),Jo()};Ko();let jo={id:"",_GALLTYPE_:"",gallery_no:0,r_key:"",upload_status:"",clickbutton:"",user_ip:"",block_key:"",tempIdx:"",headtext:"",use_headtext:"",poll:"",service_code:"",use_html:"",subject:"",adult_article_yn:"N",adult_auth_yn:"N",ci_t:void 0,mode:"W",movieIdx:"",series_title:"[]",series_data:"",headTail:'""'};rl&&(jo.fix="");let Go="",zo=(e=!0)=>{!il&&e&&vl&&Mi({title:Oe}),il=e,e?(Al()&&(Hl(ya,Ot),Hl(Xa,Ot),Hl(Da,Ot),Hl(bo,Ot)),nl||Hl(Xi,wt)):(Vl(ya,Ot),Vl(Xa,Ot),Vl(Da,Ot),Vl(bo,Ot),nl||Vl(Xi,wt))};Pi=async()=>{let e=await Ir(ir()).catch(Dl);if(!/id="write"/.test(e))return zo();if(zo(!1),Wr(e,jo),jl=cr(e),pl=/id="code"/.test(e),rl){jo.headtext=0;let t=vr(e,nl?"nickname":"name");Il=t||""}ra(),la(),a(!0)};let Yo=e=>"false||"+e,So=(e,t,l)=>`<img class="written_dccon" src="${e}" conalt="${t}" alt="${t}" con_alt="${t}" title="${t}" detail="${l}">`,Uo=0,$o=async(e,t=!0)=>{let l=`<p><a href="${e}" target="_blank">${e}</a></p>`,r=await Ar(jt+"api/ogp",{url:e});if(!r)return l;let n=JSON.parse(r);if(!n.result)return l;let i=`{{_OG_START::${e}^#^${n.og_title}^#^${n.og_description}^#^${n.og_image}::OG_END_}}`;return t&&(i=`<p><span class="og-url" style="color:#3b4890">${e}</span></p><p></p>`+i),i},Bo=async(e,t)=>{jo.subject=Nt(e);let l={};if(!nl){let e=na(),t=aa();if(0==e.length)return Yo(d);if(t.length<2)return Yo(h);l.name=e,l.password=t}if(pl){let e=oa();if(0==e.length)return Yo(f);l.kcaptcha_code=e}let r=Pt(),n=r-Uo;if(n<2e3){let e=2e3-n;Uo=r+e,await(e=>{let{r:t,p:l}=El();return Xt(t,e),l})(e)}else Uo=r;if(Go=await Ar("/block/block/",jo,l).catch(Dl),!Go)return Yo(de);jo.service_code=sr(jo.service_code);let i={block_key:Go,memo:"",code:pl?oa():void 0,bgm:"0"},a="";0!==Ga.length|(po&&null!==Ka&&!ja)&&(a+=p),po&&null!==Ka&&!ja&&(a+=`<img src="${Ka.url}"/>`+p);for(let e=0;e<Ga.length;e++){let t=Ga[e];if(!t.upload)return Yo(_e);a+=`<img src="${t.url}" class="txc-image "/>`+p,i["file_write["+e+"][file_no]"]=t.num}let o="";if(_o&&Qn.length)for(let e=0;e<Qn.length;e++){let t,l,r=Qn[e],n=r.match(qt),i=r.match(Et);if(n){if(t=n[2],l="https://youtu.be/"+t,0==e){o+=`<p><span class="og-url" style="color:#3b4890" <div=""></span></p><div class="yt_movie"><embed src="https://www.youtube.com/v/${t}?version=3" type="application/x-shockwave-flash" width="560" height="315" allowfullscreen="true"></div><a class="yt_link" href="${l}" target="_blank">${l}</a></div>`,o+=await $o(l,!1);continue}}else i?(t=i[2],l="https://www.twitch.tv/"+t):l=r;o+=await $o(l)}o&&(o+=p);let c="";for(let t of e.matchAll(Lt)){let e=t[1],l=t[2],r=$r(e,l);if(!r)continue;let n=Ur(e,l);n&&(n.buy&&(c+=So(r,l,n.idx)))}c&&(c+=p);for(let e of t.matchAll(Lt)){let l=e[0],r=e[1],n=e[2],i=$r(r,n);if(!i)continue;let a=Ur(r,n);a&&(a.buy&&(t=t.r(l,So(i,n,a.idx))))}return i.memo=Nt(a+o+p+c+t),await Ml(Ar,[Yt,jo,l],i,"comment_submit")};bo.onclick=async()=>{if(!ya.value)return;let e=ya.value??"";if(ya.value="",ya.oninput(),0==hl){let{r:t,p:l}=El();if(0!==Ga.length){let e=!1,r=!1;for(let t of Ga)t.upload||(e=!0),t.error&&(r=!0);if(r){if(xn({title:ye,desc:we,options:[{text:v,[ft]:e=>{t(!0),e()},enter:!0},{text:O,[ft]:e=>{t(!1),e()}}]}),!await l.catch(Dl))return}else if(e)return Cn(_e)}let r=e.split("\n");e=r[0];let n=p;for(let e=1;e<r.length;e++)n+=`<p>${r[e]}</p>`;if(""!==fo){r=fo.split("\n");for(let e of r)n+=`<p style="color:#ABABAB;">${e}</p>`}n+=`<p style="color:#ABABAB;">-   ${zl(20)}</p>`,(e=>{Xt(Pi,500);let t=Yl(e);if(1==t.length)return Dl(e),Cn(pe);if("false"==t[0])return Cn(t[1]),Dl(e);let l=Zt(t[1].trim());Lo.push(l),Mi({num:l,nickname:ia(),id:nl?cl:"",ip:nl?"":Ul(jo.user_ip),title:jo.subject,img:sl,fix:ul,my:!0}),ja=!1;for(let e=0;e<Ga.length;e++)Ga[e].close();Ga.length=0,Sa(!1)})(await Bo(e,n).catch(Dl))}else gl=zl(8),((e,t)=>{Xt(ra,500);let l=Yl(e);l.length<2?(Dl(e),Cn(pe)):"false"==l[0]?(Dl(e),Cn(l[1])):(i(0),$i[t](-1,!0))})(await(async(e,t,l=0)=>{let r=Io[e];if(!r)return 0;let n={};if(l&&(n.c_no=l),nl)n.name=ol;else{if(Il)n.nickname=Il;else{let e=na();if(0==e.length)return Yo(d);n.name=e}let e=aa();if(e.length<2)return Yo(h);n.password=e}if(dl){let e=oa();if(0==e.length)return Yo(f);n.code=e}n.memo=Nt(t);let i={id:Ft,no:e,c_gall_id:Ft,c_gall_no:e,[bt]:"",_GALLTYPE_:Ht,headTail:'""'},a=await Ml(Dr,[e,St,r,n],i,"comment_submit");try{let e=Zt(a);if(e)return"true||"+e}catch{Dl(a)}return a})(hl,e+gl,fl).catch(Dl),hl);ot&&ya.focus()},(()=>{let e=nt?.getItem(gt)??"";if(e){ln=JSON.parse(e);for(let e in ln)an(e,ln[e])}})(),0!==Qn.length&&jn(!1);let Zo=cn("version")??"";if("undefined"!=typeof VERSION){let e=e=>{let t=e.split(".");return t[0]+"."+t[1]};if(e(Zo)!==e(VERSION)){let e=xn({title:Ye+": "+VERSION,desc:et+'<a href="https://joh1ah.github.io/dclivechat/change.log" target="_blank">'+Se+"</a>",html:!0});Ln(e.content,[{text:$e,icon:"delete"},{hr:!0},{text:I,icon:"open_in_new"},{text:Me},{hr:!0},{text:Xe},{text:Qe}]);let t=e.content.oncontextmenu({preventDefault:()=>{},clientX:0,clientY:0});In=null,(Mo=t).parentNode.removeChild(Mo),e.content.appendChild(t),t.style.position="relative",t.style.marginTop="1em"}}var Mo;on("version",VERSION),(()=>{let e=cn("zzal");if(null!==e&&""!==e)try{let t=(e=>{let{p:t,i:l}=Ua(qa,e);Hl(t,"up"),l.src=e.src;let r={preview:t,img:l,original:e.name,name:e.name,size:e.size,type:e.type,upload:!0,file:null,error:!1,num:null,url:e.url,close:()=>{t.remove();for(let t=0;t<Ga.length;t++){let l=Ga[t];if(e===l){Ga.splice(t,1);break}}Ya()}},n=Pl("a",t,"close.abs-tr.b");return Rl(n,"delete","f"),n.onclick=()=>r.close(),r})(JSON.parse(e));Ba(t)}catch{Ba(null)}})(),fo=cn("footer")??"",Mt((()=>Vl(lt,wt))),Dl("INIT done")})().catch((e=>console.log(e)));
